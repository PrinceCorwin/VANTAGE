<UserControl x:Class="VANTAGE.Views.ScheduleView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
             xmlns:skinManager="clr-namespace:Syncfusion.SfSkinManager;assembly=Syncfusion.SfSkinManager.WPF"
             skinManager:SfSkinManager.Theme="{skinManager:SkinManagerExtension ThemeName=FluentDark}"
             Background="{StaticResource BackgroundColor}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- TOOLBAR -->
        <Border Grid.Row="0"
                Background="{StaticResource ToolbarBackground}"
                BorderBrush="{StaticResource ControlBorder}"
                BorderThickness="0,0,0,1"
                Height="50">
            <StackPanel Orientation="Horizontal" 
                       Margin="15,0"
                       VerticalAlignment="Center">

                <TextBlock Text="Week Ending:" 
                          VerticalAlignment="Center"
                          Foreground="{StaticResource ForegroundColor}"
                          Margin="0,0,10,0"/>
                <ComboBox x:Name="cmbWeekEndDate"
                         Width="150"
                         Height="32"
                         ItemsSource="{Binding AvailableWeekEndDates}"
                         SelectedItem="{Binding SelectedWeekEndDate, Mode=TwoWay}"
                         Background="{StaticResource ControlBackground}"
                         Foreground="{StaticResource ControlForeground}"
                         BorderBrush="{StaticResource ControlBorder}"
                         Margin="0,0,20,0">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding StringFormat='yyyy-MM-dd'}"/>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>

                <TextBlock Text="Filters:" 
                          VerticalAlignment="Center"
                          Foreground="{StaticResource ForegroundColor}"
                          Margin="0,0,10,0"/>

                <ToggleButton x:Name="btnFilterActualStart"
                             Content="Actual Start"
                             Width="100"
                             Height="32"
                             IsChecked="{Binding FilterActualStart, Mode=TwoWay}"
                             Background="{StaticResource ControlBackground}"
                             Foreground="{StaticResource ForegroundColor}"
                             BorderBrush="{StaticResource ControlBorder}"
                             BorderThickness="1"
                             HorizontalContentAlignment="Center"
                             FontSize="11"
                             Margin="0,0,5,0"/>

                <ToggleButton x:Name="btnFilterActualFinish"
                             Content="Actual Finish"
                             Width="100"
                             Height="32"
                             IsChecked="{Binding FilterActualFinish, Mode=TwoWay}"
                             Background="{StaticResource ControlBackground}"
                             Foreground="{StaticResource ForegroundColor}"
                             BorderBrush="{StaticResource ControlBorder}"
                             BorderThickness="1"
                             HorizontalContentAlignment="Center"
                             FontSize="11"
                             Margin="0,0,5,0"/>

                <ToggleButton x:Name="btnFilter3WLA"
                             Content="3WLA"
                             Width="100"
                             Height="32"
                             IsChecked="{Binding Filter3WLA, Mode=TwoWay}"
                             Background="{StaticResource ControlBackground}"
                             Foreground="{StaticResource ForegroundColor}"
                             BorderBrush="{StaticResource ControlBorder}"
                             BorderThickness="1"
                             HorizontalContentAlignment="Center"
                             FontSize="11"
                             Margin="0,0,20,0"/>
            </StackPanel>
        </Border>
        
        <!-- MASTER GRID -->
        <syncfusion:SfDataGrid x:Name="sfScheduleMaster"
                      Grid.Row="1"
                      ItemsSource="{Binding MasterRows}"
                      AutoGenerateColumns="False"
                      AllowEditing="True"
                      EditTrigger="OnTap"
                      ColumnSizer="Star"
                      SelectionMode="Single"
                      GridLinesVisibility="Both"
                      HeaderRowHeight="35"
                      RowHeight="30"
                      AllowSorting="True"
                      AllowFiltering="True"
                      AllowResizingColumns="True"
                      AllowDraggingColumns="True"
                      ShowRowHeader="True"
                      RowHeaderWidth="30">

            <syncfusion:SfDataGrid.Columns>

                <syncfusion:GridTextColumn MappingName="SchedActNO" 
                                          HeaderText="SchedActNO" 
                                          Width="120"
                                          AllowEditing="False"/>

                <syncfusion:GridTextColumn MappingName="Description" 
                                          HeaderText="Description" 
                                          Width="250"
                                          AllowEditing="False"/>

                <syncfusion:GridDateTimeColumn MappingName="P6_ActualStart" 
                                              HeaderText="P6 Start" 
                                              Width="110"
                                              DisplayBinding="{Binding P6_ActualStart, StringFormat='yyyy-MM-dd'}"
                                              AllowEditing="False"/>

                <syncfusion:GridDateTimeColumn MappingName="P6_ActualFinish" 
                                              HeaderText="P6 Finish" 
                                              Width="110"
                                              DisplayBinding="{Binding P6_ActualFinish, StringFormat='yyyy-MM-dd'}"
                                              AllowEditing="False"/>

                <syncfusion:GridNumericColumn MappingName="P6_PercentComplete" 
                                             HeaderText="P6 %" 
                                             Width="80"
                                             NumberDecimalDigits="1"
                                             AllowEditing="False"/>

                <syncfusion:GridNumericColumn MappingName="P6_BudgetMHs" 
                                             HeaderText="P6 MHs" 
                                             Width="90"
                                             NumberDecimalDigits="1"
                                             AllowEditing="False"/>

                <syncfusion:GridDateTimeColumn MappingName="MS_ActualStart" 
                                              HeaderText="MS Start" 
                                              Width="110"
                                              DisplayBinding="{Binding MS_ActualStart, StringFormat='yyyy-MM-dd'}"
                                              AllowEditing="False"/>

                <syncfusion:GridDateTimeColumn MappingName="MS_ActualFinish" 
                                              HeaderText="MS Finish" 
                                              Width="110"
                                              DisplayBinding="{Binding MS_ActualFinish, StringFormat='yyyy-MM-dd'}"
                                              AllowEditing="False"/>

                <syncfusion:GridNumericColumn MappingName="MS_PercentComplete" 
                                             HeaderText="MS %" 
                                             Width="80"
                                             NumberDecimalDigits="1"
                                             AllowEditing="False"/>

                <syncfusion:GridNumericColumn MappingName="MS_BudgetMHs" 
                                             HeaderText="MS MHs" 
                                             Width="90"
                                             NumberDecimalDigits="1"
                                             AllowEditing="False"/>

                <syncfusion:GridTextColumn MappingName="MissedStartReason" 
                                          HeaderText="Missed Start Reason" 
                                          Width="200"
                                          AllowEditing="True"/>

                <syncfusion:GridTextColumn MappingName="MissedFinishReason" 
                                          HeaderText="Missed Finish Reason" 
                                          Width="200"
                                          AllowEditing="True"/>

                <syncfusion:GridDateTimeColumn MappingName="ThreeWeekStart" 
                                              HeaderText="3WLA Start" 
                                              Width="110"
                                              AllowEditing="True"/>

                <syncfusion:GridDateTimeColumn MappingName="ThreeWeekFinish" 
                                              HeaderText="3WLA Finish" 
                                              Width="110"
                                              AllowEditing="True"/>
            </syncfusion:SfDataGrid.Columns>
        </syncfusion:SfDataGrid>

        <!-- STATUS BAR -->
        <Border Grid.Row="2"
                Background="{StaticResource ToolbarBackground}"
                BorderBrush="{StaticResource ControlBorder}"
                BorderThickness="0,1,0,0"
                Height="30">
            <StackPanel Orientation="Horizontal" 
                       Margin="15,0"
                       VerticalAlignment="Center">
                <TextBlock x:Name="txtStatus"
                          Text="Ready"
                          Foreground="{StaticResource ForegroundColor}"
                          FontSize="12"/>
            </StackPanel>
        </Border>

        <!-- LOADING OVERLAY -->
        <Grid Grid.Row="1"
              Background="#CC000000"
              Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}"
              Panel.ZIndex="1000">
            <StackPanel HorizontalAlignment="Center"
                       VerticalAlignment="Center">
                <syncfusion:SfBusyIndicator IsBusy="True"
                                           AnimationType="DualRing"
                                           ViewboxWidth="80"
                                           ViewboxHeight="80"
                                           Foreground="{StaticResource AccentColor}"/>
                <TextBlock Text="Loading schedule data..."
                          FontSize="16"
                          Foreground="White"
                          HorizontalAlignment="Center"
                          Margin="0,20,0,0"/>
            </StackPanel>
        </Grid>
    </Grid>
</UserControl>