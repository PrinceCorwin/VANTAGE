<UserControl x:Class="VANTAGE.Views.ProgressView"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
     xmlns:svg="http://sharpvectors.codeplex.com/runtime/"
          xmlns:styles="clr-namespace:VANTAGE.Styles"
             mc:Ignorable="d"
     d:DesignHeight="600" d:DesignWidth="1200"
      Background="{StaticResource BackgroundColor}">

    <UserControl.Resources>
        <styles:RecordOwnershipRowStyleSelector x:Key="RowStyleSelector" />
        <!-- Style for empty/null required fields with red border -->
        <Style x:Key="CompTypeRequiredStyle" TargetType="syncfusion:GridCell">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=CompType}" Value="">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=CompType}" Value="{x:Null}">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="PhaseCategoryRequiredStyle" TargetType="syncfusion:GridCell">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=PhaseCategory}" Value="">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=PhaseCategory}" Value="{x:Null}">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="ProjectIDRequiredStyle" TargetType="syncfusion:GridCell">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=ProjectID}" Value="">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=ProjectID}" Value="{x:Null}">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="WorkPackageRequiredStyle" TargetType="syncfusion:GridCell">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=WorkPackage}" Value="">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=WorkPackage}" Value="{x:Null}">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="PhaseCodeRequiredStyle" TargetType="syncfusion:GridCell">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=PhaseCode}" Value="">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=PhaseCode}" Value="{x:Null}">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="ROCStepRequiredStyle" TargetType="syncfusion:GridCell">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=ROCStep}" Value="">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=ROCStep}" Value="{x:Null}">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="DescRequiredStyle" TargetType="syncfusion:GridCell">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=Description}" Value="">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=Description}" Value="{x:Null}">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="SchedActNoRequiredStyle" TargetType="syncfusion:GridCell">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=SchedActNO}" Value="">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=SchedActNO}" Value="{x:Null}">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="UDF18RequiredStyle" TargetType="syncfusion:GridCell">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=UDF18}" Value="">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Path=UDF18}" Value="{x:Null}">
                    <Setter Property="Background" Value="#5b2626"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

    </UserControl.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="100"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- LEFT SIDEBAR: Quick Filters & Controls -->
        <Border Grid.Column="0" 
                BorderThickness="1"
                Padding="10,0,10,10"
                Background="{StaticResource DarkBackgroundColor}"
                BorderBrush="{StaticResource BorderColor}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!-- Sidebar Controls -->
                <StackPanel Grid.Row="0">
                    <TextBlock Text="QUICK FILTERS" 
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               FontSize="11" 
                               FontWeight="Bold"
                               Height="30"
                               Padding="10"
                               Foreground="{StaticResource ForegroundColor}"
                               Margin="0,0,0,10"/>

                    <Button x:Name="btnFilterComplete"
                            Content="Complete"
                            Height="35"
                            Margin="0,0,0,5"
                            Background="{StaticResource ControlBackground}"
                            Foreground="{StaticResource ForegroundColor}"
                            BorderBrush="{StaticResource ControlBorder}"
                            BorderThickness="1"
                            HorizontalContentAlignment="Center"
                            Padding="10,0"
                            FontSize="11"
                            Click="BtnFilterComplete_Click"/>

                    <Button x:Name="btnFilterInProgress"
                        Content="In Progress"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource ControlBorder}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Center"
                        Padding="10,0"
                        FontSize="11"
                        Click="btnFilterInProgress_Click"/>

                    <Button x:Name="btnFilterNotStarted"
                        Content="Not Started"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource ControlBorder}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Center"
                        Padding="10,0"
                        FontSize="11"
                        Click="BtnFilterNotStarted_Click"/>

                    <Button x:Name="btnFilterUser2"
                        Content="USER 2"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource ControlBorder}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Center"
                        Padding="10,0"
                        FontSize="11"
                        Click="BtnFilterUser2_Click"/>

                    <Button x:Name="btnFilterUser3"
                        Content="USER 3"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource ControlBorder}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Center"
                        Padding="10,0"
                        FontSize="11"
                        Click="BtnFilterUser3_Click"/>

                    <Button x:Name="btnFilterMyRecords"
                            Content="My Records"
                            Height="35"
                            Margin="0,0,0,0"
                            Background="{StaticResource ControlBackground}"
                            Foreground="{StaticResource ForegroundColor}"
                            BorderBrush="{StaticResource ControlBorder}"
                            BorderThickness="1"
                            HorizontalContentAlignment="Center"
                            Padding="10,0"
                            FontSize="11"
                            Click="BtnFilterMyRecords_Click"/>
                    
                    <Border Height="1" 
                        Background="{StaticResource ControlBorder}" 
                        Margin="0,10,0,10"/>

                    <Button x:Name="btnClearFilters"
                        Content="Clear Filters"
                        Height="35"
                        Margin="0,0,0,0"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource StatusGreen}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Center"
                        Padding="10,0"
                        FontSize="11"
                        Click="BtnClearFilters_Click"/>

                    <Border Height="1" 
                        Background="{StaticResource ControlBorder}" 
                        Margin="0,10,0,10"/>

                    <Button x:Name="btnAssign"
                                Content="Assign"
                                Height="28"
                                Margin="0,0,0,0"
                                Background="{StaticResource ControlBackground}"
                                Foreground="{StaticResource ForegroundColor}"
                                BorderBrush="{StaticResource ControlBorder}"
                                BorderThickness="1"
                                Padding="10,0"
                                FontSize="11"
                                VerticalContentAlignment="Center"
                                Click="MenuAssignToUser_Click"
                                ToolTip="Assign selected records to user"/>

                    <Border Height="1" 
                        Background="{StaticResource ControlBorder}" 
                        Margin="0,10,0,10"/>

                    <Button x:Name="btnColumnVisibility"
                            Content="Columns"
                            Height="35"
                            Margin="0,0,0,0"
                            Background="{StaticResource ControlBackground}"
                            Foreground="{StaticResource ForegroundColor}"
                            BorderBrush="{StaticResource ControlBorder}"
                            BorderThickness="1"
                            HorizontalContentAlignment="Center"
                            Padding="10,0"
                            FontSize="11"
                            Click="BtnColumnVisibility_Click"/>

                </StackPanel>
                <!-- Spacer (pushes logo to bottom) -->
                <Border Grid.Row="1" Height="20"/>
                <!-- Logo at the bottom -->
                <Border Grid.Row="3" 
                        Margin="0,0,0,0" 
                        Padding="0" 
                        HorizontalAlignment="Center" 
                        VerticalAlignment="Bottom">
                    <Image Width="80" 
                           Source="pack://application:,,,/images/SummitLogoNoText.jpg" 
                           Stretch="Uniform" />
                </Border>
            </Grid>
        </Border>

        <!-- RIGHT SIDE: DataGrid -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <!-- Row 0: Toolbar -->
                <RowDefinition Height="Auto"/>
                <!-- Row 2: DataGrid-->
                <RowDefinition Height="*"/>
                <!-- Row 2: Footer-->
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Combined Toolbar + Summary Panel -->
            <Border Grid.Row="0"
                    BorderThickness="0,1,1,1"
                    Background="{StaticResource DarkBackgroundColor}"
                    BorderBrush="{StaticResource BorderColor}"
                    Padding="10,5">

                <Grid VerticalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- LEFT SIDE: Refresh and Custom Percent Buttons -->
                    <StackPanel Grid.Column="0" 
                                Orientation="Horizontal" 
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center">

                        <Button x:Name="btnRefresh"
                                Content="REFRESH"
                                Width="80"
                                Margin="15,0,5,0"
                                Background="{StaticResource ControlBackground}"
                                Foreground="{StaticResource ForegroundColor}"
                                BorderBrush="{StaticResource ControlBorder}"
                                BorderThickness="1"
                                Padding="5"
                                FontSize="12"
                                VerticalContentAlignment="Center"
                                Click="BtnRefresh_Click"/>

                        <Button x:Name="btnSetPercent100"
                                Content="100%"
                                Tag="Button1|CustomPercentButton1|100"
                                Width="60"
                                Margin="5,0"
                                Background="{StaticResource ControlBackground}"
                                Foreground="{StaticResource ForegroundColor}"
                                BorderBrush="{StaticResource ControlBorder}"
                                BorderThickness="1"
                                Padding="5"
                                FontSize="12"
                                VerticalContentAlignment="Center"
                                Click="BtnSetPercent_Click"
                                ToolTip="Left-click: Apply | Right-click: Customize">
                            <Button.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Reset Button to 100%" Click="MenuItem_ResetPercent_Click" Tag="100"/>
                                    <Separator/>
                                    <MenuItem Header="Custom Percent..." Click="MenuItem_CustomPercent_Click"/>
                                </ContextMenu>
                            </Button.ContextMenu>
                        </Button>

                        <Button x:Name="btnSetPercent0"
                                Content="0%"
                                Tag="Button2|CustomPercentButton2|0"
                                Width="60"
                                Margin="5,0"
                                Background="{StaticResource ControlBackground}"
                                Foreground="{StaticResource ForegroundColor}"
                                BorderBrush="{StaticResource ControlBorder}"
                                BorderThickness="1"
                                Padding="5"
                                FontSize="12"
                                VerticalContentAlignment="Center"
                                Click="BtnSetPercent_Click"
                                ToolTip="Left-click: Apply | Right-click: Customize">
                            <Button.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Reset Button to 0%" Click="MenuItem_ResetPercent_Click" Tag="0"/>
                                    <Separator/>
                                    <MenuItem Header="Custom Percent..." Click="MenuItem_CustomPercent_Click"/>
                                </ContextMenu>
                            </Button.ContextMenu>
                        </Button>
                    </StackPanel>

                    <!-- CENTER: Sync and Submit Buttons -->
                    <StackPanel Grid.Column="1" 
                                Orientation="Horizontal" 
                                HorizontalAlignment="Center"
                                Margin="0,0,100,0"
                                VerticalAlignment="Center">

                        <Button x:Name="btnSync"
                                Content="SYNC"
                                Width="80"
                                Margin="10,0"
                                Background="{StaticResource ControlBackgroundGreen}"
                                Foreground="{StaticResource ForegroundColor}"
                                BorderBrush="{StaticResource ControlBorder}"
                                BorderThickness="1"
                                Padding="5"
                                FontSize="12"
                                VerticalContentAlignment="Center"
                                Click="BtnSync_Click"/>

                        <Button x:Name="btnSubmit"
                                Content="SUBMIT WEEK"
                                Width="150"
                                Margin="10,0"
                                Background="{StaticResource ControlBackgroundRed}"
                                Foreground="{StaticResource ForegroundColor}"
                                BorderBrush="{StaticResource ControlBorder}"
                                BorderThickness="1"
                                Padding="5"
                                FontSize="12"
                                VerticalContentAlignment="Center"
                                Click="BtnSubmit_Click"/>
                    </StackPanel>

                    <!-- RIGHT SIDE: Summary stats -->
                    <StackPanel Grid.Column="2" 
                                Orientation="Horizontal" 
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center">

                        <!-- Budgeted MHs -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,30,0">
                            <TextBlock Text="Budgeted MHs:"
                                       Foreground="{StaticResource TextColorSecondary}"
                                       FontSize="14"
                                       VerticalAlignment="Center"/>
                                        <TextBlock Text="{Binding BudgetedMHs, StringFormat=N2}"
                                       Foreground="{StaticResource AccentColor}"
                                       FontSize="14"
                                       FontWeight="Bold"
                                       VerticalAlignment="Center"
                                       Margin="5,0,0,0"/>
                        </StackPanel>

                        <!-- Earned MHs -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,30,0">
                            <TextBlock Text="Earned MHs:"
                                       Foreground="{StaticResource TextColorSecondary}"
                                       FontSize="14"
                                       VerticalAlignment="Center"/>
                                        <TextBlock Text="{Binding EarnedMHs, StringFormat=N2}"
                                       Foreground="{StaticResource StatusGreen}"
                                       FontSize="14"
                                       FontWeight="Bold"
                                       VerticalAlignment="Center"
                                       Margin="5,0,0,0"/>
                        </StackPanel>

                        <!-- Percent Complete -->
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Percent Complete:"
                                       Foreground="{StaticResource TextColorSecondary}"
                                       FontSize="14"
                                       VerticalAlignment="Center"/>
                            <TextBlock Text="{Binding PercentComplete, StringFormat='{}{0:N2}%'}"
                                       Foreground="{StaticResource StatusInProgress}"
                                       FontSize="14"
                                       FontWeight="Bold"
                                       VerticalAlignment="Center"
                                       Margin="5,0,0,0"/>
                        </StackPanel>
                    </StackPanel>

                </Grid>
            </Border>

            <!-- DataGrid with VIRTUALIZATION ENABLED -->
            <Border Grid.Row="1" 
                    BorderBrush="{StaticResource ControlBorder}" 
                    BorderThickness="0">
                <syncfusion:SfDataGrid x:Name="sfActivities"
                    AutoGenerateColumns="False"
                    AllowEditing="True"
                    EditTrigger="OnTap"
                    AddNewRowPosition="None"
                    AllowDraggingColumns="True"
                    AllowResizingColumns="True"
                    AllowSorting="True"
                    AllowFiltering="True"
                    SelectionMode="Extended"
                    SelectionUnit="Any"
                    ColumnSizer="Auto"
                    Background="{StaticResource BackgroundColor}"
                    Foreground="{StaticResource ForegroundColor}"
                    BorderBrush="{StaticResource ControlBorder}"
                    BorderThickness="0"
                    GridLinesVisibility="Both"
                    RowHeight="28"
                    HeaderRowHeight="32"
                    RowStyleSelector="{StaticResource RowStyleSelector}"
                    ShowRowHeader="True"
                    GridContextMenuOpening="sfActivities_GridContextMenuOpening"
                    CurrentCellEndEdit="sfActivities_CurrentCellEndEdit"
                    SelectionChanged="sfActivities_SelectionChanged"
                    CurrentCellBeginEdit="SfActivities_CurrentCellBeginEdit">
                    <!--<syncfusion:SfDataGrid.AlternatingRowStyle>
                        <Style TargetType="syncfusion:VirtualizingCellsControl">
                            <Setter Property="Background" Value="{StaticResource GridAlternatingRowBackground}"/>
                        </Style>
                    </syncfusion:SfDataGrid.AlternatingRowStyle>-->
                    <syncfusion:SfDataGrid.HeaderStyle>
                        <Style TargetType="syncfusion:GridHeaderCellControl">
                            <Setter Property="Background" Value="{StaticResource GridHeaderBackground}"/>
                            <Setter Property="Foreground" Value="{StaticResource TextColorSecondary}"/>
                        </Style>
                    </syncfusion:SfDataGrid.HeaderStyle>

                    <syncfusion:SfDataGrid.RecordContextMenu>
                        <ContextMenu
                             Background="{StaticResource ControlBackground}"
                             Foreground="{StaticResource ForegroundColor}"
                             BorderBrush="{StaticResource ControlBorder}">

                            <!-- Delete Row(s) -->
                            <MenuItem Header="Delete Row(s)"
                                      Click="DeleteSelectedActivities_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="#FFE74C3C">
                                <MenuItem.Icon>
                                    <TextBlock Text="🗑️" FontSize="14"/>
                                </MenuItem.Icon>
                            </MenuItem>

                            <!-- Placeholder 1 -->
                            <MenuItem Header="Copy Row(s)"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}">
                                <MenuItem.Icon>
                                    <TextBlock Text="📋" FontSize="14"/>
                                </MenuItem.Icon>
                                <MenuItem Header="Copy (Visible Columns)"
                                          Click="MenuCopyVisibleColumns_Click"
                                          Background="{StaticResource ControlBackground}"
                                          Foreground="{StaticResource ForegroundColor}"/>
                                <MenuItem Header="Copy (All Columns)"
                                          Click="MenuCopyAllColumns_Click"
                                          Background="{StaticResource ControlBackground}"
                                          Foreground="{StaticResource ForegroundColor}"/>
                            </MenuItem>

                            <!-- Placeholder 2 -->
                            <MenuItem Header="Duplicate Row(s)"
                                      Click="MenuDuplicateRows_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"
                                      IsEnabled="True">
                                <MenuItem.Icon>
                                    <TextBlock Text="➕" FontSize="14"/>
                                </MenuItem.Icon>
                            </MenuItem>

                            <!-- Placeholder 3 -->
                            <MenuItem Header="Export Selected"
                                      Click="MenuExportSelected_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"
                                      IsEnabled="True">
                                <MenuItem.Icon>
                                    <TextBlock Text="📤" FontSize="14"/>
                                </MenuItem.Icon>
                            </MenuItem>

                            <!-- Placeholder 4 -->
                            <MenuItem Header="Placeholder 1"
                                      Click="PlaceHolder1_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"
                                      IsEnabled="False">
                                <MenuItem.Icon>
                                    <TextBlock Text="⭐" FontSize="14"/>
                                </MenuItem.Icon>
                            </MenuItem>

                            <!-- Placeholder 5 -->
                            <MenuItem Header="Placeholder 2"
                                      Click="Placeholder2_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"
                                      IsEnabled="False">
                                <MenuItem.Icon>
                                    <TextBlock Text="🕒" FontSize="14"/>
                                </MenuItem.Icon>
                            </MenuItem>

                        </ContextMenu>
                    </syncfusion:SfDataGrid.RecordContextMenu>
                    <syncfusion:SfDataGrid.HeaderContextMenu>
                        <ContextMenu Background="{StaticResource ControlBackground}"
                                     Foreground="{StaticResource ForegroundColor}"
                                     BorderBrush="{StaticResource ControlBorder}">
                            <MenuItem Header="Find &amp; Replace in this column..." 
                                      Click="MenuFindReplaceColumn_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}">
                                <MenuItem.Icon>
                                    <TextBlock Text="🔍" FontSize="14"/>
                                </MenuItem.Icon>
                            </MenuItem>
                        </ContextMenu>
                    </syncfusion:SfDataGrid.HeaderContextMenu>
                    <syncfusion:SfDataGrid.Columns>

                        <!-- IDENTITY & KEY FIELDS -->
                        <syncfusion:GridTextColumn MappingName="UniqueID" 
                              HeaderText="UniqueID" 
                              Width="120" 
                              AllowEditing="False"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="ProjectID" 
                              HeaderText="ProjectID" 
                              Width="100"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" 
                              CellStyle="{StaticResource ProjectIDRequiredStyle}"/>

                        <syncfusion:GridTextColumn MappingName="AssignedTo" 
                              HeaderText="AssignedTo" 
                              Width="120"
                              AllowEditing="False"
                              AllowFiltering="True"
                              AllowSorting="True" />
                        
                        <syncfusion:GridTextColumn MappingName="CompType" 
                              HeaderText="CompType" 
                              Width="120"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" 
                              CellStyle="{StaticResource CompTypeRequiredStyle}" />

                        <syncfusion:GridTextColumn MappingName="PhaseCategory" 
                              HeaderText="PhaseCategory" 
                              Width="120"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              CellStyle="{StaticResource PhaseCategoryRequiredStyle}" />

                        <syncfusion:GridTextColumn MappingName="ROCStep" 
                              HeaderText="ROCStep" 
                              Width="100"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" 
                              CellStyle="{StaticResource ROCStepRequiredStyle}"/>

                        <syncfusion:GridTextColumn MappingName="Description" 
                              HeaderText="Description" 
                              Width="250"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" 
                              CellStyle="{StaticResource DescRequiredStyle}"/>

                        <syncfusion:GridNumericColumn MappingName="EarnQtyEntry" 
                                 HeaderText="EarnQtyEntry" 
                                 Width="100"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="Quantity" 
                                 HeaderText="Quantity" 
                                 Width="100"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="3" />

                        <syncfusion:GridNumericColumn MappingName="EarnedQtyCalc" 
                                 HeaderText="EarnedQtyCalc" 
                                 Width="100"
                                 AllowEditing="False"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="3" />

                        <syncfusion:GridNumericColumn MappingName="PercentEntry" 
                                 HeaderText="PercentEntry" 
                                 Width="100"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="PercentCompleteCalc" 
                                 HeaderText="PercentCompleteCalc" 
                                 Width="100"
                                 AllowEditing="False"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="BudgetMHs" 
                                 HeaderText="BudgetMHs" 
                                 Width="100"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="3" />

                        <syncfusion:GridNumericColumn MappingName="EarnMHsCalc" 
                                 HeaderText="EarnMHsCalc" 
                                 Width="100"
                                 AllowEditing="False"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="3" />

                        <syncfusion:GridTextColumn MappingName="WorkPackage" 
                              HeaderText="WorkPackage" 
                              Width="120"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" 
                              CellStyle="{StaticResource WorkPackageRequiredStyle}"/>

                        <syncfusion:GridTextColumn MappingName="PhaseCode" 
                              HeaderText="PhaseCode" 
                              Width="100"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" 
                              CellStyle="{StaticResource PhaseCodeRequiredStyle}"/>

                        <syncfusion:GridTextColumn MappingName="SchedActNO" 
                              HeaderText="SchedActNO" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" 
                              CellStyle="{StaticResource SchedActNoRequiredStyle}"/>

                        <!-- DRAWING FIELDS -->
                        <syncfusion:GridTextColumn MappingName="DwgNO" 
                              HeaderText="DwgNO" 
                              Width="120"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <!-- ALPHABETICALLY SORTED XAML COLUMNS BY NAME (77 total) -->
                        <!-- All original properties preserved -->

                        <syncfusion:GridTextColumn MappingName="Area"
                           HeaderText="Area"
                           Width="80"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="Aux1"
                           HeaderText="Aux1"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="Aux2"
                           HeaderText="Aux2"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="Aux3"
                           HeaderText="Aux3"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridDateTimeColumn MappingName="AzureUploadUtcDate"
                               HeaderText="AzureUploadUtcDate"
                               Width="120"
                               IsHidden="True"
                               AllowEditing="False"
                               AllowFiltering="True"
                               AllowSorting="True"
                               Pattern="ShortDate" />

                        <syncfusion:GridNumericColumn MappingName="BaseUnit"
                              HeaderText="BaseUnit"
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="BudgetHoursGroup"
                              HeaderText="BudgetHoursGroup"
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="BudgetHoursROC"
                              HeaderText="BudgetHoursROC"
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="2" />

                        <syncfusion:GridTextColumn MappingName="ChgOrdNO"
                           HeaderText="ChgOrdNO"
                           Width="80"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridNumericColumn MappingName="ClientBudget"
                              HeaderText="ClientBudget"
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="3" />

                        <syncfusion:GridNumericColumn MappingName="ClientCustom3"
                              HeaderText="ClientCustom3"
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="2" />

                        <syncfusion:GridTextColumn MappingName="ClientEquivEarnQTY"
                           HeaderText="ClientEquivEarnQTY"
                           Width="150"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridNumericColumn MappingName="ClientEquivQty"
                              HeaderText="ClientEquivQty"
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="2" />

                        <syncfusion:GridTextColumn MappingName="CreatedBy"
                           HeaderText="CreatedBy"
                           Width="120"
                           IsHidden="True"
                           AllowEditing="False"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridNumericColumn MappingName="DateTrigger"
                              HeaderText="DateTrigger"
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="0" />

                        <syncfusion:GridNumericColumn MappingName="EarnedMHsRoc"
                              HeaderText="EarnedMHsRoc"
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="2" />

                        <syncfusion:GridTextColumn MappingName="EqmtNO"
                           HeaderText="EqmtNO"
                           Width="120"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="EquivQTY"
                           HeaderText="EquivQTY"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="EquivUOM"
                           HeaderText="EquivUOM"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="Estimator"
                           HeaderText="Estimator"
                           Width="120"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridNumericColumn MappingName="HexNO"
                              HeaderText="HexNO"
                              Width="80"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="0" />

                        <syncfusion:GridTextColumn MappingName="HtTrace"
                           HeaderText="HtTrace"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="InsulType"
                           HeaderText="InsulType"
                           Width="120"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="LineNO"
                           HeaderText="LineNO"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridNumericColumn MappingName="LocalDirty"
                              HeaderText="LocalDirty"
                              Width="100"
                              IsHidden="False"
                              AllowEditing="False"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="0" />

                        <syncfusion:GridTextColumn MappingName="MtrlSpec"
                           HeaderText="MtrlSpec"
                           Width="120"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="Notes"
                           HeaderText="Notes"
                           Width="200"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="PaintCode"
                           HeaderText="PaintCode"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="PipeGrade"
                           HeaderText="PipeGrade"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridNumericColumn MappingName="PipeSize1"
                              HeaderText="PipeSize1"
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="PipeSize2"
                              HeaderText="PipeSize2"
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="2" />

                        <syncfusion:GridTextColumn MappingName="PjtSystem"
                           HeaderText="PjtSystem"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridNumericColumn MappingName="PrevEarnMHs"
                              HeaderText="PrevEarnMHs"
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="PrevEarnQTY"
                              HeaderText="PrevEarnQTY"
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="2" />

                        <syncfusion:GridDateTimeColumn MappingName="ProgDate"
                               HeaderText="ProgDate"
                               Width="120"
                               IsHidden="True"
                               AllowEditing="False"
                               AllowFiltering="True"
                               AllowSorting="True"
                               Pattern="ShortDate" />

                        <syncfusion:GridTextColumn MappingName="RevNO"
                           HeaderText="RevNO"
                           Width="80"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="RFINO"
                           HeaderText="RFINO"
                           Width="80"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridNumericColumn MappingName="ROCBudgetQTY"
                              HeaderText="ROCBudgetQTY"
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="ROCID"
                              HeaderText="ROCID"
                              Width="80"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="0" />

                        <syncfusion:GridTextColumn MappingName="ROCLookupID"
                           HeaderText="ROCLookupID"
                           Width="150"
                           IsHidden="True"
                           AllowEditing="False"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridNumericColumn MappingName="ROCPercent"
                              HeaderText="ROCPercent"
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="2" />

                        <syncfusion:GridDateTimeColumn MappingName="SchFinish"
                               HeaderText="SchFinish"
                               Width="100"
                               IsHidden="False"
                               AllowEditing="True"
                               AllowFiltering="True"
                               AllowSorting="True"
                               Pattern="ShortDate" />

                        <syncfusion:GridDateTimeColumn MappingName="SchStart"
                               HeaderText="SchStart"
                               Width="100"
                               IsHidden="False"
                               AllowEditing="True"
                               AllowFiltering="True"
                               AllowSorting="True"
                               Pattern="ShortDate" />

                        <syncfusion:GridTextColumn MappingName="SecondActno"
                           HeaderText="SecondActno"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="SecondDwgNO"
                           HeaderText="SecondDwgNO"
                           Width="120"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="Service"
                           HeaderText="Service"
                           Width="120"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="ShopField"
                           HeaderText="ShopField"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="ShtNO"
                           HeaderText="ShtNO"
                           Width="80"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="Status"
                           HeaderText="Status"
                           Width="100"
                           AllowEditing="False"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="SubArea"
                           HeaderText="SubArea"
                           Width="80"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="SyncVersion"
                           HeaderText="Sync Version"
                           Width="120"
                           DisplayBinding="{Binding SyncVersion}"
                           IsHidden="False"
                           AllowEditing="False"
                           AllowFiltering="True"
                           TextAlignment="Right" />

                        <syncfusion:GridTextColumn MappingName="SystemNO"
                           HeaderText="SystemNO"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="TagNO"
                           HeaderText="TagNO"
                           Width="120"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF1"
                           HeaderText="UDF1"
                           Width="100"
                           IsHidden="False"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF2"
                           HeaderText="UDF2"
                           Width="100"
                           IsHidden="False"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF3"
                           HeaderText="UDF3"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF4"
                           HeaderText="UDF4"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF5"
                           HeaderText="UDF5"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF6"
                           HeaderText="UDF6"
                           Width="100"
                           IsHidden="False"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF7"
                           HeaderText="UDF7"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF8"
                           HeaderText="UDF8"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF9"
                           HeaderText="UDF9"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF10"
                           HeaderText="UDF10"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF11"
                           HeaderText="UDF11"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF12"
                           HeaderText="UDF12"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF13"
                           HeaderText="UDF13"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF14"
                           HeaderText="UDF14"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF15"
                           HeaderText="UDF15"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF16"
                           HeaderText="UDF16"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF17"
                           HeaderText="UDF17"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF18"
                           HeaderText="UDF18"
                           Width="100"
                           IsHidden="False"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True"
                           CellStyle="{StaticResource UDF18RequiredStyle}" />

                        <syncfusion:GridTextColumn MappingName="UDF20"
                           HeaderText="UDF20"
                           Width="100"
                           IsHidden="True"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UOM"
                           HeaderText="UOM"
                           Width="80"
                           AllowEditing="True"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UpdatedBy"
                           HeaderText="UpdatedBy"
                           Width="120"
                           IsHidden="False"
                           AllowEditing="False"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UpdatedUtcDateDisplay"
                           HeaderText="UpdatedUtcDate"
                           Width="160"
                           IsHidden="True"
                           AllowEditing="False"
                           AllowFiltering="True"
                           AllowSorting="True" />

                        <syncfusion:GridDateTimeColumn MappingName="WeekEndDate"
                               HeaderText="WeekEndDate"
                               Width="120"
                               IsHidden="True"
                               AllowEditing="False"
                               AllowFiltering="True"
                               AllowSorting="True"
                               Pattern="ShortDate" />

                        <syncfusion:GridNumericColumn MappingName="XRay"
                              HeaderText="XRay"
                              Width="80"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True"
                              NumberDecimalDigits="0" />
                    </syncfusion:SfDataGrid.Columns>
                </syncfusion:SfDataGrid>
            </Border>

            <!-- BOTTOM TOOLBAR -->
            <Border Grid.Row="2" 
                    Background="{StaticResource ToolbarBackground}" 
                    BorderBrush="{StaticResource ControlBorder}" 
                    BorderThickness="0,1,0,0"
                    Padding="10,0">
                <DockPanel>
                    <!-- LEFT: Record count -->
                    <TextBlock x:Name="txtFilteredCount"
                           DockPanel.Dock="Left"
                           Text="0 records"
                           Foreground="{StaticResource TextColorSecondary}"
                           VerticalAlignment="Center"
                           Margin="10,0,0,0"/>
                    <!-- NEW: Metadata Errors Button -->
                    <Button x:Name="btnMetadataErrors"
                                DockPanel.Dock="Left"
                                Content="{Binding MetadataErrorButtonText}"
                                Click="BtnMetadataErrors_Click"
                                Background="{StaticResource ControlBackground}"
                                Foreground="{StaticResource StatusRed}"
                                BorderBrush="{StaticResource ControlBorder}"
                                BorderThickness="1"
                                Padding="8,4"
                                Margin="15,0,0,0"
                                VerticalAlignment="Center"
                                Cursor="Hand"
                                FontSize="11"
                                ToolTip="Click to view records with missing required metadata"/>

                    <StackPanel DockPanel.Dock="Right"
                        Orientation="Horizontal"
                        VerticalAlignment="Center"
                        Margin="0,0,10,0"
                        Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}">

                        <TextBlock Text="Loading..."
                           Foreground="{StaticResource TextColorSecondary}"
                           VerticalAlignment="Center"
                           Margin="0,0,10,0"
                           FontSize="12"/>

                        <ProgressBar x:Name="loadingProgressBar"
                             Width="200"
                             Height="8"
                             Minimum="0"
                             Maximum="{Binding TotalRecordCount}"
                             Foreground="{StaticResource AccentColor}"
                             BorderBrush="{StaticResource ControlBorder}"
                             BorderThickness="1"/>

                        <TextBlock Text="{Binding FilteredCount, StringFormat='{}{0:N0}'}"
                               Foreground="{StaticResource TextColorSecondary}"
                               VerticalAlignment="Center"
                               Margin="8,0,0,0"
                               FontSize="11"/>
                    </StackPanel>
                    <Border/>
                </DockPanel>
            </Border>
        </Grid>
    </Grid>
</UserControl>
    