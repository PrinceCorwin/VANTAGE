<UserControl x:Class="VANTAGE.Views.ProgressView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
             xmlns:svg="http://sharpvectors.codeplex.com/runtime/"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="1200"
             Background="{StaticResource BackgroundColor}">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="150"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- LEFT SIDEBAR: Quick Filters & Controls -->
        <Border Grid.Column="0" 
                Background="{StaticResource SidebarBackground}" 
                BorderBrush="{StaticResource SidebarBorder}" 
                BorderThickness="0,0,1,0"
                Padding="10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!-- Sidebar Controls -->
                <StackPanel Grid.Row="0">
                    <TextBlock Text="QUICK FILTERS" 
                           FontSize="12" 
                           FontWeight="Bold"
                           Foreground="{StaticResource TextColorSecondary}"
                           Margin="0,0,0,10"/>

                    <Button x:Name="btnFilterComplete"
                        Content="Complete"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterComplete_Click"/>

                    <Button x:Name="btnFilterNotComplete"
                        Content="Not Complete"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterNotComplete_Click"/>

                    <Button x:Name="btnFilterNotStarted"
                        Content="Not Started"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterNotStarted_Click"/>

                    <Button x:Name="btnFilterUser2"
                        Content="USER 2"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterUser2_Click"/>

                    <Button x:Name="btnFilterUser3"
                        Content="USER 3"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterUser3_Click"/>

                    <Button x:Name="btnFilterMyRecords"
                        Content="My Records"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterMyRecords_Click"/>

                    <Button x:Name="btnClearFilters"
                        Content="Clear Filters"
                        Height="35"
                        Margin="0,20,0,0"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource AccentColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Center"
                        Padding="10,0"
                        Click="BtnClearFilters_Click"/>

                    <Border Height="1" 
                        Background="{StaticResource BorderColor}" 
                        Margin="0,20,0,20"/>

                    <TextBlock Text="COLUMN VISIBILITY" 
                        FontSize="12" 
                        FontWeight="Bold"
                        Foreground="{StaticResource TextColorSecondary}"
                        Margin="0,0,0,10"/>

                    <ListBox x:Name="lstColumnVisibility"
                        Height="200"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        SelectionMode="Multiple"
                        SelectionChanged="LstColumnVisibility_SelectionChanged">
                </ListBox>
                </StackPanel>

                <!-- Logo at the bottom -->
                <Border Grid.Row="1" Margin="0,20,0,0" Padding="5" Background="Transparent" HorizontalAlignment="Center" VerticalAlignment="Bottom">
                    <Image Width="120" Height="60" Source="pack://application:,,,/images/SummitS-Full Summit Peak Logo.jpg" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Border>
            </Grid>
        </Border>

        <!-- RIGHT SIDE: DataGrid -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/>
                <!-- Row 0: Filters/toolbar -->
                <RowDefinition Height="Auto"/>
                <!-- Row 1:Summary panel -->
                <RowDefinition Height="*"/>
                <!-- Row 2: DataGrid (was Row 1) -->
                <RowDefinition Height="40"/>
                <!-- Row 3: Paging (was Row 2) -->
            </Grid.RowDefinitions>

            <!-- Combined Toolbar + Summary Panel -->
            <Border Grid.Row="0"
                    Background="{StaticResource ToolbarBackground}"
                    BorderBrush="{StaticResource BorderColor}"
                    BorderThickness="0,0,0,1"
                    Padding="10,0">
                        <DockPanel LastChildFill="True" VerticalAlignment="Center">
                    <!-- LEFT SIDE: Search controls -->
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Left" VerticalAlignment="Center">
                        <TextBlock Text="Search:"
                                   Foreground="{StaticResource TextColorSecondary}"
                                   VerticalAlignment="Center"
                                   Margin="0,0,10,0"/>
                        <TextBox x:Name="txtSearch"
                                 Width="250"
                                 Height="25"
                                 Background="{StaticResource ControlBackground}"
                                 Foreground="{StaticResource ForegroundColor}"
                                 BorderBrush="{StaticResource BorderColor}"
                                 BorderThickness="1"
                                 Padding="5"
                                 VerticalContentAlignment="Center"
                                 TextChanged="TxtSearch_TextChanged"/>

                        <Button x:Name="btnRefresh"
                                Content="Refresh"
                                Width="80"
                                Height="28"
                                Margin="20,0,0,0"
                                Background="{StaticResource ControlBackground}"
                                Foreground="{StaticResource ForegroundColor}"
                                BorderBrush="{StaticResource BorderColor}"
                                BorderThickness="1"
                                Click="BtnRefresh_Click"/>

                        <!-- NEW: Bulk Action Buttons -->
                        <Button x:Name="btnAssign"
                                Content="Assign ▼"
                                Width="90"
                                Height="28"
                                Margin="20,0,5,0"
                                Background="{StaticResource ControlBackground}"
                                Foreground="{StaticResource ForegroundColor}"
                                BorderBrush="{StaticResource BorderColor}"
                                BorderThickness="1"
                                Padding="5,2,5,2"
                                VerticalContentAlignment="Center"
                                Click="BtnAssign_Click"
                                ToolTip="Assign selected records">
                            <Button.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Assign to Me" Click="MenuAssignToMe_Click"/>
                                    <MenuItem Header="Unassign" Click="MenuUnassign_Click"/>
                                    <Separator/>
                                    <MenuItem Header="Assign to User..." Click="MenuAssignToUser_Click"/>
                                </ContextMenu>
                            </Button.ContextMenu>
                        </Button>

                        <Button x:Name="btnSetPercent100"
                                Content="100%"
                                Tag="Button1|CustomPercentButton1|100"
                                Width="60"
                                Height="28"
                                Margin="5,0"
                                Background="{StaticResource ControlBackground}"
                                Foreground="{StaticResource ForegroundColor}"
                                BorderBrush="{StaticResource BorderColor}"
                                BorderThickness="1"
                                Click="BtnSetPercent_Click"
                                ToolTip="Left-click: Apply | Right-click: Customize">
                            <Button.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Reset Button to 100%" Click="MenuItem_ResetPercent_Click" Tag="100"/>
                                    <Separator/>
                                    <MenuItem Header="Custom Percent..." Click="MenuItem_CustomPercent_Click"/>
                                </ContextMenu>
                            </Button.ContextMenu>
                        </Button>

                        <Button x:Name="btnSetPercent0"
                                Content="0%"
                                Tag="Button2|CustomPercentButton2|0"
                                Width="60"
                                Height="28"
                                Margin="5,0"
                                Background="{StaticResource ControlBackground}"
                                Foreground="{StaticResource ForegroundColor}"
                                BorderBrush="{StaticResource BorderColor}"
                                BorderThickness="1"
                                Click="BtnSetPercent_Click"
                                ToolTip="Left-click: Apply | Right-click: Customize">
                            <Button.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Reset Button to 0%" Click="MenuItem_ResetPercent_Click" Tag="0"/>
                                    <Separator/>
                                    <MenuItem Header="Custom Percent..." Click="MenuItem_CustomPercent_Click"/>
                                </ContextMenu>
                            </Button.ContextMenu>
                        </Button>
                    </StackPanel>

                    <!-- RIGHT SIDE: Summary stats -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" DockPanel.Dock="Right">
                        <!-- Budgeted MHs -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,30,0">
                            <TextBlock Text="Budgeted MHs:"
                               Foreground="{StaticResource TextColorSecondary}"
                               FontSize="14"
                               VerticalAlignment="Center"/>
                            <TextBlock Text="{Binding BudgetedMHs, StringFormat=N2}"
                               Foreground="{StaticResource AccentColor}"
                               FontSize="16"
                               FontWeight="Bold"
                               VerticalAlignment="Center"
                               Margin="5,0,0,0"/>
                        </StackPanel>

                        <!-- Earned MHs -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,30,0">
                            <TextBlock Text="Earned MHs:"
                               Foreground="{StaticResource TextColorSecondary}"
                               FontSize="14"
                               VerticalAlignment="Center"/>
                            <TextBlock Text="{Binding EarnedMHs, StringFormat=N2}"
                               Foreground="{StaticResource StatusGreen}"
                               FontSize="16"
                               FontWeight="Bold"
                               VerticalAlignment="Center"
                               Margin="5,0,0,0"/>
                        </StackPanel>

                        <!-- Percent Complete -->
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Percent Complete:"
                               Foreground="{StaticResource TextColorSecondary}"
                               FontSize="14"
                               VerticalAlignment="Center"/>
                            <TextBlock Text="{Binding PercentComplete, StringFormat='{}{0:N2}%'}"
                                Foreground="{StaticResource StatusInProgress}"
                                FontSize="16"
                                FontWeight="Bold"
                                VerticalAlignment="Center"
                                Margin="5,0,0,0"/>
                        </StackPanel>
                    </StackPanel>

                </DockPanel>
            </Border>

            <!-- DataGrid with VIRTUALIZATION ENABLED -->
            <Border Grid.Row="2" 
                    BorderBrush="{StaticResource BorderColor}" 
                    BorderThickness="0">
                <syncfusion:SfDataGrid x:Name="sfActivities"
                    AutoGenerateColumns="False"
                    AllowEditing="True"
                    EditTrigger="OnTap"
                    AddNewRowPosition="None"
                    AllowDraggingColumns="True"
                    AllowResizingColumns="True"
                    AllowSorting="True"
                    AllowFiltering="True"
                    SelectionMode="Extended"
                    SelectionUnit="Row"
                    ColumnSizer="Auto"
                    Background="{StaticResource BackgroundColor}"
                    Foreground="{StaticResource ForegroundColor}"
                    BorderBrush="{StaticResource BorderColor}"
                    BorderThickness="0"
                    GridLinesVisibility="Both"
                    RowHeight="28"
                    HeaderRowHeight="32"
                    CurrentCellEndEdit="sfActivities_CurrentCellEndEdit"
                    SelectionChanged="sfActivities_SelectionChanged"
                    CurrentCellBeginEdit="sfActivities_CurrentCellBeginEdit">
                    
                    <syncfusion:SfDataGrid.ContextMenu>
                        <ContextMenu
                             Background="{StaticResource ControlBackground}"
                             Foreground="{StaticResource ForegroundColor}"
                             BorderBrush="{StaticResource BorderColor}">

                            <!-- Delete Row(s) -->
                            <MenuItem Header="Delete Row(s)"
                                      Click="DeleteSelectedActivities_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="#FFE74C3C">
                                <MenuItem.Icon>
                                    <TextBlock Text="🗑️" FontSize="14"/>
                                </MenuItem.Icon>
                            </MenuItem>

                            <Separator Background="{StaticResource BorderColor}"/>

                            <!-- Placeholder 1 -->
                            <MenuItem Header="Copy Row(s)"
                                      Click="MenuCopyRows_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"
                                      IsEnabled="False">
                                <MenuItem.Icon>
                                    <TextBlock Text="📋" FontSize="14"/>
                                </MenuItem.Icon>
                            </MenuItem>

                            <!-- Placeholder 2 -->
                            <MenuItem Header="Duplicate Row(s)"
                                      Click="MenuDuplicateRows_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"
                                      IsEnabled="False">
                                <MenuItem.Icon>
                                    <TextBlock Text="➕" FontSize="14"/>
                                </MenuItem.Icon>
                            </MenuItem>

                            <Separator Background="{StaticResource BorderColor}"/>

                            <!-- Placeholder 3 -->
                            <MenuItem Header="Export Selected"
                                      Click="MenuExportSelected_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"
                                      IsEnabled="True">
                                <MenuItem.Icon>
                                    <TextBlock Text="📤" FontSize="14"/>
                                </MenuItem.Icon>
                            </MenuItem>

                            <!-- Placeholder 4 -->
                            <MenuItem Header="Placeholder 1"
                                      Click="PlaceHolder1_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"
                                      IsEnabled="False">
                                <MenuItem.Icon>
                                    <TextBlock Text="⭐" FontSize="14"/>
                                </MenuItem.Icon>
                            </MenuItem>

                            <Separator Background="{StaticResource BorderColor}"/>

                            <!-- Placeholder 5 -->
                            <MenuItem Header="Placeholder 2"
                                      Click="Placeholder2_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"
                                      IsEnabled="False">
                                <MenuItem.Icon>
                                    <TextBlock Text="🕒" FontSize="14"/>
                                </MenuItem.Icon>
                            </MenuItem>

                        </ContextMenu>
                    </syncfusion:SfDataGrid.ContextMenu>
                    <syncfusion:SfDataGrid.Columns>

                        <!-- IDENTITY & KEY FIELDS -->
                        <syncfusion:GridTextColumn MappingName="UniqueID" 
                              HeaderText="UniqueID" 
                              Width="120" 
                              AllowEditing="False"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="Description" 
                              HeaderText="Description" 
                              Width="250"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="AssignedTo" 
                              HeaderText="AssignedTo" 
                              Width="120"
                              AllowEditing="False"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <!-- CATEGORY FIELDS -->
                        <syncfusion:GridTextColumn MappingName="CompType" 
                              HeaderText="CompType" 
                              Width="120"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="PhaseCategory" 
                              HeaderText="PhaseCategory" 
                              Width="120"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="ROCStep" 
                              HeaderText="ROCStep" 
                              Width="100"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="ProjectID" 
                              HeaderText="ProjectID" 
                              Width="100"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="WorkPackage" 
                              HeaderText="WorkPackage" 
                              Width="120"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="PhaseCode" 
                              HeaderText="PhaseCode" 
                              Width="100"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <!-- DRAWING FIELDS -->
                        <syncfusion:GridTextColumn MappingName="DwgNO" 
                              HeaderText="DwgNO" 
                              Width="120"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="RevNO" 
                              HeaderText="RevNO" 
                              Width="80"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="SecondDwgNO" 
                              HeaderText="SecondDwgNO" 
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="ShtNO" 
                              HeaderText="ShtNO" 
                              Width="80"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <!-- NOTES -->
                        <syncfusion:GridTextColumn MappingName="Notes" 
                              HeaderText="Notes" 
                              Width="200"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <!-- SCHEDULE FIELDS -->
                        <syncfusion:GridTextColumn MappingName="SecondActno" 
                              HeaderText="SecondActno" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="SchedActNO" 
                              HeaderText="SchedActNO" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridDateTimeColumn MappingName="Start" 
                                  HeaderText="Start" 
                                  Width="100"
                                  IsHidden="True"
                                  AllowEditing="True"
                                  AllowFiltering="True"
                                  AllowSorting="True"
                                  Pattern="ShortDate" />

                        <syncfusion:GridDateTimeColumn MappingName="Finish" 
                                  HeaderText="Finish" 
                                  Width="100"
                                  IsHidden="True"
                                  AllowEditing="True"
                                  AllowFiltering="True"
                                  AllowSorting="True"
                                  Pattern="ShortDate" />

                        <!-- AUXILIARY TAG FIELDS -->
                        <syncfusion:GridTextColumn MappingName="Aux1" 
                              HeaderText="Aux1" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="Aux2" 
                              HeaderText="Aux2" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="Aux3" 
                              HeaderText="Aux3" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="Area" 
                              HeaderText="Area" 
                              Width="80"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="ChgOrdNO" 
                              HeaderText="ChgOrdNO" 
                              Width="80"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="EqmtNO" 
                              HeaderText="EqmtNO" 
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="Estimator" 
                              HeaderText="Estimator" 
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="InsulType" 
                              HeaderText="InsulType" 
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="LineNO" 
                              HeaderText="LineNO" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="MtrlSpec" 
                              HeaderText="MtrlSpec" 
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="PaintCode" 
                              HeaderText="PaintCode" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="PipeGrade" 
                              HeaderText="PipeGrade" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="RFINO" 
                              HeaderText="RFINO" 
                              Width="80"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="Service" 
                              HeaderText="Service" 
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="ShopField" 
                              HeaderText="ShopField" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="SubArea" 
                              HeaderText="SubArea" 
                              Width="80"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="PjtSystem" 
                              HeaderText="PjtSystem" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="SystemNO" 
                              HeaderText="SystemNO" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="TagNO" 
                              HeaderText="TagNO" 
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="HtTrace" 
                              HeaderText="HtTrace" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <!-- NUMERIC TAG FIELDS -->
                        <syncfusion:GridNumericColumn MappingName="HexNO" 
                                 HeaderText="HexNO" 
                                 Width="80"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="0" />

                        <syncfusion:GridNumericColumn MappingName="ROCID" 
                                 HeaderText="ROCID" 
                                 Width="80"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="0" />

                        <syncfusion:GridNumericColumn MappingName="XRay" 
                                 HeaderText="XRay" 
                                 Width="80"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="0" />

                        <syncfusion:GridNumericColumn MappingName="DateTrigger" 
                                 HeaderText="DateTrigger" 
                                 Width="100"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="0" />

                        <!-- UDF FIELDS (USER DEFINED FIELDS) -->
                        <syncfusion:GridTextColumn MappingName="UDF1" 
                              HeaderText="UDF1" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF2" 
                              HeaderText="UDF2" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF3" 
                              HeaderText="UDF3" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF4" 
                              HeaderText="UDF4" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF5" 
                              HeaderText="UDF5" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF6" 
                              HeaderText="UDF6" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF7" 
                              HeaderText="UDF7" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF8" 
                              HeaderText="UDF8" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF9" 
                              HeaderText="UDF9" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF10" 
                              HeaderText="UDF10" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="CreatedBy" 
                              HeaderText="CreatedBy" 
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UpdatedBy" 
                              HeaderText="UpdatedBy" 
                              Width="120"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF14" 
                              HeaderText="UDF14" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF15" 
                              HeaderText="UDF15" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF16" 
                              HeaderText="UDF16" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF17" 
                              HeaderText="UDF17" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF18" 
                              HeaderText="UDF18" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="UDF20" 
                              HeaderText="UDF20" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <!-- VALUE FIELDS - QUANTITIES AND PROGRESS -->
                        <syncfusion:GridNumericColumn MappingName="Quantity" 
                                 HeaderText="Quantity" 
                                 Width="100"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridTextColumn MappingName="UOM" 
                              HeaderText="UOM" 
                              Width="80"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridNumericColumn MappingName="EarnQtyEntry" 
                                 HeaderText="EarnQtyEntry" 
                                 Width="100"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="PercentEntry" 
                                 HeaderText="PercentEntry" 
                                 Width="100"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="BudgetMHs" 
                                 HeaderText="BudgetMHs" 
                                 Width="100"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <!-- CALCULATED FIELDS (READ-ONLY) -->
                        <syncfusion:GridNumericColumn MappingName="EarnMHsCalc" 
                                 HeaderText="EarnMHsCalc" 
                                 Width="100"
                                 AllowEditing="False"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="3" />

                        <syncfusion:GridTextColumn MappingName="Status" 
                              HeaderText="Status" 
                              Width="100"
                              AllowEditing="False"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridNumericColumn MappingName="EarnedQtyCalc" 
                                 HeaderText="EarnedQtyCalc" 
                                 Width="100"
                                 AllowEditing="False"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="PercentCompleteCalc" 
                                 HeaderText="PercentCompleteCalc" 
                                 Width="100"
                                 AllowEditing="False"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridTextColumn MappingName="ROCLookupID" 
                              HeaderText="ROCLookupID" 
                              Width="150"
                              IsHidden="True"
                              AllowEditing="False"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <!-- ADDITIONAL VALUE FIELDS -->
                        <syncfusion:GridNumericColumn MappingName="BaseUnit" 
                                 HeaderText="BaseUnit" 
                                 Width="100"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="BudgetHoursGroup" 
                                 HeaderText="BudgetHoursGroup" 
                                 Width="120"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="BudgetHoursROC" 
                                 HeaderText="BudgetHoursROC" 
                                 Width="120"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="EarnedMHsRoc" 
                                 HeaderText="EarnedMHsRoc" 
                                 Width="120"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridTextColumn MappingName="EquivUOM" 
                              HeaderText="EquivUOM" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridTextColumn MappingName="EquivQTY" 
                              HeaderText="EquivQTY" 
                              Width="100"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridNumericColumn MappingName="PipeSize1" 
                                 HeaderText="PipeSize1" 
                                 Width="100"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="PipeSize2" 
                                 HeaderText="PipeSize2" 
                                 Width="100"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="PrevEarnMHs" 
                                 HeaderText="PrevEarnMHs" 
                                 Width="120"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="PrevEarnQTY" 
                                 HeaderText="PrevEarnQTY" 
                                 Width="120"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="ROCBudgetQTY" 
                                 HeaderText="ROCBudgetQTY" 
                                 Width="120"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="ROCPercent" 
                                 HeaderText="ROCPercent" 
                                 Width="100"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="ClientBudget" 
                                 HeaderText="ClientBudget" 
                                 Width="120"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridNumericColumn MappingName="ClientCustom3" 
                                 HeaderText="ClientCustom3" 
                                 Width="120"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <syncfusion:GridTextColumn MappingName="ClientEquivEarnQTY" 
                              HeaderText="ClientEquivEarnQTY" 
                              Width="150"
                              IsHidden="True"
                              AllowEditing="True"
                              AllowFiltering="True"
                              AllowSorting="True" />

                        <syncfusion:GridNumericColumn MappingName="ClientEquivQty" 
                                 HeaderText="ClientEquivQty" 
                                 Width="120"
                                 IsHidden="True"
                                 AllowEditing="True"
                                 AllowFiltering="True"
                                 AllowSorting="True"
                                 NumberDecimalDigits="2" />

                        <!-- TIMESTAMP FIELDS -->
                        <syncfusion:GridDateTimeColumn MappingName="WeekEndDate" 
                                  HeaderText="WeekEndDate" 
                                  Width="120"
                                  IsHidden="True"
                                  AllowEditing="False"
                                  AllowFiltering="True"
                                  AllowSorting="True"
                                  Pattern="ShortDate" />

                        <syncfusion:GridDateTimeColumn MappingName="ProgDate" 
                                  HeaderText="ProgDate" 
                                  Width="120"
                                  IsHidden="True"
                                  AllowEditing="False"
                                  AllowFiltering="True"
                                  AllowSorting="True"
                                  Pattern="ShortDate" />

                        <syncfusion:GridDateTimeColumn MappingName="AzureUploadUtcDate" 
                                  HeaderText="AzureUploadUtcDate" 
                                  Width="120"
                                  IsHidden="True"
                                  AllowEditing="False"
                                  AllowFiltering="True"
                                  AllowSorting="True"
                                  Pattern="ShortDate" />

                    </syncfusion:SfDataGrid.Columns>
                </syncfusion:SfDataGrid>
            </Border>

            <!-- BOTTOM TOOLBAR -->
            <Border Grid.Row="3" 
                    Background="{StaticResource ToolbarBackground}" 
                    BorderBrush="{StaticResource BorderColor}" 
                    BorderThickness="0,1,0,0"
                    Padding="10,0">
                <DockPanel>
                    <!-- LEFT: Record count -->
                    <TextBlock x:Name="txtFilteredCount"
                           DockPanel.Dock="Left"
                           Text="0 records"
                           Foreground="{StaticResource TextColorSecondary}"
                           VerticalAlignment="Center"
                           Margin="10,0,0,0"/>

                    <StackPanel DockPanel.Dock="Right"
                        Orientation="Horizontal"
                        VerticalAlignment="Center"
                        Margin="0,0,10,0"
                        Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}">

                        <TextBlock Text="Loading..."
                           Foreground="{StaticResource TextColorSecondary}"
                           VerticalAlignment="Center"
                           Margin="0,0,10,0"
                           FontSize="12"/>

                        <ProgressBar x:Name="loadingProgressBar"
                             Width="200"
                             Height="8"
                             Minimum="0"
                             Maximum="{Binding TotalRecordCount}"
                             Foreground="{StaticResource AccentColor}"
                             BorderBrush="{StaticResource BorderColor}"
                             BorderThickness="1"/>

                        <TextBlock Text="{Binding FilteredCount, StringFormat='{}{0:N0}'}"
                               Foreground="{StaticResource TextColorSecondary}"
                               VerticalAlignment="Center"
                               Margin="8,0,0,0"
                               FontSize="11"/>
                    </StackPanel>
                    <Border/>
                </DockPanel>
            </Border>
        </Grid>
    </Grid>
</UserControl>