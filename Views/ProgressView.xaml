<UserControl x:Class="VANTAGE.Views.ProgressView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="1200"
             Background="{StaticResource BackgroundColor}">

    <UserControl.Resources>
        <!-- Column Header with Filter Button -->
        <DataTemplate x:Key="FilterableColumnHeader">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" 
                       Text="{Binding}" 
                       VerticalAlignment="Center"
                       Foreground="{StaticResource ForegroundColor}"/>

                <Button Grid.Column="1"
                        Content="▼"
                        Width="20"
                        Height="20"
                        Margin="5,0,0,0"
                        Click="FilterButton_Click"
                        Tag="{Binding}"
                        ToolTip="Filter this column"
                        Cursor="Hand">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <TextBlock Text="{TemplateBinding Content}"
                                       Foreground="{StaticResource ForegroundColor}"
                                       FontSize="14"
                                       FontWeight="Bold"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       Background="Transparent"/>
                        </ControlTemplate>
                    </Button.Template>
                </Button>
            </Grid>
        </DataTemplate>
    </UserControl.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="175"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- LEFT SIDEBAR: Quick Filters & Controls -->
        <Border Grid.Column="0" 
                Background="{StaticResource SidebarBackground}" 
                BorderBrush="{StaticResource SidebarBorder}" 
                BorderThickness="0,0,1,0"
                Padding="10">
            <StackPanel>
                <TextBlock Text="QUICK FILTERS" 
                           FontSize="12" 
                           FontWeight="Bold"
                           Foreground="{StaticResource TextColorSecondary}"
                           Margin="0,0,0,10"/>

                <Button x:Name="btnFilterComplete"
                        Content="Complete"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterComplete_Click"/>

                <Button x:Name="btnFilterNotComplete"
                        Content="Not Complete"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterNotComplete_Click"/>

                <Button x:Name="btnFilterPipe"
                        Content="USER 1"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterUser1_Click"/>

                <Button x:Name="btnFilterSteel"
                        Content="USER 2"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterUser2_Click"/>

                <Button x:Name="btnFilterElec"
                        Content="USER 3"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterUser3_Click"/>

                <Button x:Name="btnFilterMyRecords"
                        Content="My Records"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterMyRecords_Click"/>

                <Button x:Name="btnClearFilters"
                        Content="Clear Filters"
                        Height="35"
                        Margin="0,20,0,0"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource AccentColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Center"
                        Padding="10,0"
                        Click="BtnClearFilters_Click"/>

                <Border Height="1" 
                        Background="{StaticResource BorderColor}" 
                        Margin="0,20,0,20"/>

                <TextBlock Text="COLUMN VISIBILITY" 
                           FontSize="12" 
                           FontWeight="Bold"
                           Foreground="{StaticResource TextColorSecondary}"
                           Margin="0,0,0,10"/>

                <ListBox x:Name="lstColumnVisibility"
                         Height="200"
                         Background="{StaticResource ControlBackground}"
                         Foreground="{StaticResource ForegroundColor}"
                         BorderBrush="{StaticResource BorderColor}"
                         BorderThickness="1"
                         SelectionMode="Multiple"
                         SelectionChanged="LstColumnVisibility_SelectionChanged">
                </ListBox>

                <TextBlock Text="Select columns to show/hide" 
                           FontSize="10" 
                           Foreground="{StaticResource DisabledColor}"
                           Margin="0,5,0,0"
                           TextWrapping="Wrap"/>
            </StackPanel>
        </Border>

        <!-- RIGHT SIDE: DataGrid -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/> <!-- Row 0: Filters/toolbar -->
                <RowDefinition Height="Auto"/> <!-- Row 1: ADD THIS - Summary panel -->
                <RowDefinition Height="*"/> <!-- Row 2: DataGrid (was Row 1) -->
                <RowDefinition Height="40"/> <!-- Row 3: Paging (was Row 2) -->
            </Grid.RowDefinitions>

            <!-- Combined Toolbar + Summary Panel -->
            <Border Grid.Row="0"
                    Background="{StaticResource ToolbarBackground}"
                    BorderBrush="{StaticResource BorderColor}"
                    BorderThickness="0,0,0,1"
                    Padding="10,0">
                <DockPanel LastChildFill="True" VerticalAlignment="Center">

                    <!-- LEFT SIDE: Search controls -->
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Left" VerticalAlignment="Center">
                        <TextBlock Text="Search:"
                                   Foreground="{StaticResource TextColorSecondary}"
                                   VerticalAlignment="Center"
                                   Margin="0,0,10,0"/>
                        <TextBox x:Name="txtSearch"
                                 Width="250"
                                 Height="25"
                                 Background="{StaticResource ControlBackground}"
                                 Foreground="{StaticResource ForegroundColor}"
                                 BorderBrush="{StaticResource BorderColor}"
                                 BorderThickness="1"
                                 Padding="5"
                                 VerticalContentAlignment="Center"
                                 TextChanged="TxtSearch_TextChanged"/>

                        <Button x:Name="btnRefresh"
                                Content="Refresh"
                                Width="80"
                                Height="28"
                                Margin="20,0,0,0"
                                Background="{StaticResource ControlBackground}"
                                Foreground="{StaticResource ForegroundColor}"
                                BorderBrush="{StaticResource BorderColor}"
                                BorderThickness="1"
                                Click="BtnRefresh_Click"/>

                        <TextBlock x:Name="txtFilteredCount"
                                   Text="0 records"
                                   Foreground="{StaticResource TextColorSecondary}"
                                   VerticalAlignment="Center"
                                   Margin="20,0,0,0"/>
                    </StackPanel>

                    <!-- RIGHT SIDE: Summary stats -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" DockPanel.Dock="Right">
                        <!-- Budgeted MHs -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,30,0">
                            <TextBlock Text="Budgeted MHs:"
                           Foreground="{StaticResource TextColorSecondary}"
                           FontSize="14"
                           VerticalAlignment="Center"/>
                            <TextBlock x:Name="txtBudgetedMHs"
                           Text="0.00"
                           Foreground="{StaticResource AccentColor}"
                           FontSize="16"
                           FontWeight="Bold"
                           VerticalAlignment="Center"
                           Margin="5,0,0,0"/>
                        </StackPanel>

                        <!-- Earned MHs -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,30,0">
                            <TextBlock Text="Earned MHs:"
                           Foreground="{StaticResource TextColorSecondary}"
                           FontSize="14"
                           VerticalAlignment="Center"/>
                            <TextBlock x:Name="txtEarnedMHs"
                           Text="0.00"
                           Foreground="{StaticResource StatusGreen}"
                           FontSize="16"
                           FontWeight="Bold"
                           VerticalAlignment="Center"
                           Margin="5,0,0,0"/>
                        </StackPanel>

                        <!-- Percent Complete -->
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Percent Complete:"
                           Foreground="{StaticResource TextColorSecondary}"
                           FontSize="14"
                           VerticalAlignment="Center"/>
                            <TextBlock x:Name="txtPercentComplete"
                           Text="0.00%"
                           Foreground="{StaticResource StatusInProgress}"
                           FontSize="16"
                           FontWeight="Bold"
                           VerticalAlignment="Center"
                           Margin="5,0,0,0"/>
                        </StackPanel>
                    </StackPanel>

                </DockPanel>
            </Border>

            <!-- DataGrid with VIRTUALIZATION ENABLED -->
            <Border Grid.Row="2" 
                    BorderBrush="{StaticResource BorderColor}" 
                    BorderThickness="0">
                <DataGrid x:Name="dgActivities"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          CanUserReorderColumns="True"
                          CanUserSortColumns="True"
                          SelectionMode="Extended"
                          SelectionUnit="FullRow"
                          EnableRowVirtualization="True"
                          EnableColumnVirtualization="True"
                          VirtualizingPanel.IsVirtualizing="True"
                          VirtualizingPanel.VirtualizationMode="Recycling"
                          Background="{StaticResource BackgroundColor}"
                          Foreground="{StaticResource ForegroundColor}"
                          BorderBrush="{StaticResource BorderColor}"
                          BorderThickness="0"
                          GridLinesVisibility="All"
                          HorizontalGridLinesBrush="{StaticResource BorderColor}"
                          VerticalGridLinesBrush="{StaticResource BorderColor}"
                          RowHeight="28"
                          HeadersVisibility="Column"
                          RowEditEnding="DgActivities_RowEditEnding"
                          SelectionChanged="DgActivities_SelectionChanged"
                          BeginningEdit="DgActivities_BeginningEdit">

                    <DataGrid.ColumnHeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="Background" Value="{StaticResource GridHeaderBackground}"/>
                            <Setter Property="Foreground" Value="{StaticResource GridHeaderForeground}"/>
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Setter Property="FontSize" Value="12"/>
                            <Setter Property="Padding" Value="8,5"/>
                            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
                            <Setter Property="BorderThickness" Value="0,0,1,1"/>
                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                        </Style>
                    </DataGrid.ColumnHeaderStyle>

                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <Setter Property="Background" Value="{StaticResource BackgroundColor}"/>
                            <Setter Property="Foreground" Value="{StaticResource ForegroundColor}"/>
                            <Style.Triggers>
                                <!-- Green background for my records (editable) -->
                                <DataTrigger Binding="{Binding IsMyRecord}" Value="True">
                                    <Setter Property="Background" Value="{StaticResource MyRecordsBackground}"/>
                                </DataTrigger>

                                <!-- Grey background/text for non-editable records -->
                                <DataTrigger Binding="{Binding IsEditable}" Value="False">
                                    <Setter Property="Background" Value="{StaticResource ReadOnlyBackground}"/>
                                    <Setter Property="Foreground" Value="{StaticResource DisabledColor}"/>
                                </DataTrigger>

                                <!-- Selected row (overrides other backgrounds) -->
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="{StaticResource GridSelectedRowBackground}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.RowStyle>

                    <DataGrid.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
                            <Setter Property="BorderThickness" Value="0,0,1,0"/>
                            <Setter Property="Padding" Value="5,0"/>
                            <Style.Triggers>
                                <!-- Selected cell styling -->
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="{StaticResource GridSelectedRowBackground}"/>
                                    <Setter Property="Foreground" Value="{StaticResource ForegroundColor}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.CellStyle>

                    <DataGrid.ContextMenu>
                        <ContextMenu Background="{StaticResource ControlBackground}" 
                                     Foreground="{StaticResource ForegroundColor}"
                                     BorderBrush="{StaticResource BorderColor}">
                            <MenuItem Header="Assign to Me" 
                                      Click="MenuAssignToMe_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"/>
                            <MenuItem Header="Assign to User..." 
                                      Click="MenuAssignToUser_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"/>
                            <MenuItem Header="Unassign" 
                                      Click="MenuUnassign_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"/>
                            <Separator Background="{StaticResource BorderColor}"/>
                            <MenuItem Header="Mark Complete (100%)" 
                                      Click="MenuMarkComplete_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"/>
                            <MenuItem Header="Mark Not Started (0%)" 
                                      Click="MenuMarkNotStarted_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"/>
                        </ContextMenu>
                    </DataGrid.ContextMenu>


                    <DataGrid.Columns>
                        <DataGridTextColumn Header="UniqueID" 
                                            Binding="{Binding UniqueID}" 
                                            Width="120"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Background" Value="{StaticResource ReadOnlyBackground}"/>
                                    <Setter Property="Foreground" Value="{StaticResource DisabledColor}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Binding="{Binding Description}"
                                            Width="250">
                            <DataGridTextColumn.Header>
                                <ContentControl Content="Description" 
                                                ContentTemplate="{StaticResource FilterableColumnHeader}"/>
                            </DataGridTextColumn.Header>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="CompType" 
                                            Binding="{Binding CompType}" 
                                            Width="120"/>

                        <DataGridTextColumn Header="PhaseCategory" 
                                            Binding="{Binding PhaseCategory}" 
                                            Width="120"/>

                        <DataGridTextColumn Header="ROCStep" 
                                            Binding="{Binding ROCStep}"
                                            Width="100"/>

                        <DataGridTextColumn Header="ProjectID" 
                                            Binding="{Binding ProjectID}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="WorkPackage" 
                                            Binding="{Binding WorkPackage}" 
                                            Width="120"/>

                        <DataGridTextColumn Header="PhaseCode" 
                                            Binding="{Binding PhaseCode}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="Drawing No" 
                                            Binding="{Binding DwgNO}" 
                                            Width="120"/>

                        <DataGridTextColumn Header="Start" 
                                            Binding="{Binding Start}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="Finish" 
                                            Binding="{Binding Finish}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="SchedActNO" 
                                            Binding="{Binding SchedActNO}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="Quantity" 
                                            Binding="{Binding Quantity, StringFormat=N2}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="EarnQtyEntry" 
                                            Binding="{Binding EarnQtyEntry, StringFormat=N2, UpdateSourceTrigger=LostFocus}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="% Complete" 
                                            Binding="{Binding PercentEntry_Display, StringFormat=N2}"
                                            Width="100"/>

                        <DataGridTextColumn Header="BudgetMHs" 
                                            Binding="{Binding BudgetMHs, StringFormat=N2}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="EarnMHsCalc" 
                                            Binding="{Binding EarnMHsCalc, StringFormat=N3}" 
                                            Width="100"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Background" Value="{StaticResource ReadOnlyBackground}"/>
                                    <Setter Property="Foreground" Value="{StaticResource DisabledColor}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="Status" 
                                            Binding="{Binding Status}" 
                                            Width="100"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Background" Value="{StaticResource ReadOnlyBackground}"/>
                                    <Setter Property="Foreground" Value="{StaticResource DisabledColor}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="UDFOne" 
                                            Binding="{Binding UDFOne}" 
                                            Width="120"/>

                        <DataGridTextColumn Header="UDFTwo" 
                                            Binding="{Binding UDFTwo}" 
                                            Width="120"/>

                        <DataGridTextColumn Header="AssignedTo" 
                                            Binding="{Binding AssignedTo}" 
                                            IsReadOnly="True"
                                            Width="120">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Background" Value="{StaticResource ReadOnlyBackground}"/>
                                    <Setter Property="Foreground" Value="{StaticResource DisabledColor}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <!-- ALL OTHER COLLAPSED COLUMNS (keeping exactly as you have them) -->
                        <DataGridTextColumn Header="HexNO" 
                                                Binding="{Binding HexNO}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <!-- Drawings -->
                        <DataGridTextColumn Header="RevNO" 
                                                Binding="{Binding RevNO}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="SecondDwgNO" 
                                                Binding="{Binding SecondDwgNO}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="ShtNO" 
                                                Binding="{Binding ShtNO}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <!-- Notes -->
                        <DataGridTextColumn Header="Notes" 
                                                Binding="{Binding Notes}" 
                                                Width="200"
                                                Visibility="Collapsed"/>

                        <!-- Schedule Additional -->
                        <DataGridTextColumn Header="OldActno" 
                                                Binding="{Binding OldActno}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <!-- Tags - Auxiliary -->
                        <DataGridTextColumn Header="Aux1" 
                                                Binding="{Binding Aux1}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Aux2" 
                                                Binding="{Binding Aux2}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Aux3" 
                                                Binding="{Binding Aux3}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Area" 
                                                Binding="{Binding Area}"
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="ChgOrdNO" 
                                                Binding="{Binding ChgOrdNO}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="EqmtNO" 
                                                Binding="{Binding EqmtNO}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Estimator" 
                                                Binding="{Binding Estimator}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="InsulType" 
                                                Binding="{Binding InsulType}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="LineNO" 
                                                Binding="{Binding LineNO}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="MtrlSpec" 
                                                Binding="{Binding MtrlSpec}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="PaintCode" 
                                                Binding="{Binding PaintCode}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="PipeGrade" 
                                                Binding="{Binding PipeGrade}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="RFINO" 
                                                Binding="{Binding RFINO}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Service" 
                                                Binding="{Binding Service}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="ShopField" 
                                                Binding="{Binding ShopField}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="SubArea" 
                                                Binding="{Binding SubArea}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="System" 
                                                Binding="{Binding System}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="SystemNO" 
                                                Binding="{Binding SystemNO}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="TagNO" 
                                                Binding="{Binding TagNO}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="HtTrace" 
                                                Binding="{Binding HtTrace}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="XRay" 
                                                Binding="{Binding XRay, StringFormat=N2}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <!-- Trigger -->
                        <DataGridTextColumn Header="DateTrigger" 
                                                Binding="{Binding DateTrigger}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <!-- UDF Fields (remaining) -->
                        <DataGridTextColumn Header="UDF3" 
                                                Binding="{Binding UDFThree}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF4" 
                                                Binding="{Binding UDFFour}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF5" 
                                                Binding="{Binding UDFFive}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF6" 
                                                Binding="{Binding UDFSix}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF7" 
                                                Binding="{Binding UDFSeven}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF8" 
                                                Binding="{Binding UDFEight}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF9" 
                                                Binding="{Binding UDFNine}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF10" 
                                                Binding="{Binding UDFTen}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="LastModifiedBy" 
                                                Binding="{Binding LastModifiedBy}" 
                                                Width="150"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="CreatedBy" 
                                                Binding="{Binding CreatedBy}" 
                                                Width="150"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF14" 
                                                Binding="{Binding UDFFourteen}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF15" 
                                                Binding="{Binding UDFFifteen}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF16" 
                                                Binding="{Binding UDFSixteen}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF17" 
                                                Binding="{Binding UDFSeventeen}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF18" 
                                                Binding="{Binding UDFEighteen}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF20" 
                                                Binding="{Binding UDFTwenty}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <!-- Values - Additional -->
                        <DataGridTextColumn Header="BaseUnit" 
                                                Binding="{Binding BaseUnit, StringFormat=N2}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="BudgetHoursGroup" 
                                                Binding="{Binding BudgetHoursGroup, StringFormat=N2}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="BudgetHoursROC" 
                                                Binding="{Binding BudgetHoursROC, StringFormat=N2}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="EarnedMHsRoc" 
                                                Binding="{Binding EarnedMHsRoc}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UOM" 
                                                Binding="{Binding UOM}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <!-- Calculated fields -->
                        <DataGridTextColumn Header="Earn Qty (Calc)" 
                                            Binding="{Binding EarnedQtyCalc_Display, StringFormat=N2}"
                                            Width="100"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Background" Value="{StaticResource ReadOnlyBackground}"/>
                                    <Setter Property="Foreground" Value="{StaticResource DisabledColor}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="Percent Complete Calc" 
                                            Binding="{Binding PercentCompleteCalc_Display, StringFormat=N2}"
                                            Width="100"
                                            IsReadOnly="True">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Background" Value="{StaticResource ReadOnlyBackground}"/>
                                                    <Setter Property="Foreground" Value="{StaticResource DisabledColor}"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <!-- Equipment Quantity -->
                        <DataGridTextColumn Header="EquivQTY" 
                                                Binding="{Binding EquivQTY, StringFormat=N2}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="EquivUOM" 
                                                Binding="{Binding EquivUOM}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <!-- ROC -->
                        <DataGridTextColumn Header="ROCID" 
                                                Binding="{Binding ROCID}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="ROCLookupID" 
                                                Binding="{Binding ROCLookupID}" 
                                                Width="200"
                                                IsReadOnly="True"
                                                Visibility="Collapsed">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Background" Value="{StaticResource ReadOnlyBackground}"/>
                                    <Setter Property="Foreground" Value="{StaticResource DisabledColor}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="ROCPercent" 
                                                Binding="{Binding ROCPercent, StringFormat=N2}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="ROCBudgetQTY" 
                                                Binding="{Binding ROCBudgetQTY, StringFormat=N2}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <!-- Pipe -->
                        <DataGridTextColumn Header="PipeSize1" 
                                                Binding="{Binding PipeSize1, StringFormat=N2}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="PipeSize2" 
                                                Binding="{Binding PipeSize2, StringFormat=N2}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <!-- Previous Values -->
                        <DataGridTextColumn Header="PrevEarnMHs" 
                                                Binding="{Binding PrevEarnMHs, StringFormat=N2}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="PrevEarnQTY" 
                                                Binding="{Binding PrevEarnQTY, StringFormat=N2}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <!-- WeekEndDate -->
                        <DataGridTextColumn Header="WeekEndDate" 
                                                Binding="{Binding WeekEndDate}" 
                                                Width="150"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="AzureUploadDate" 
                                            Binding="{Binding AzureUploadDate}"
                                            Width="150"
                                            Visibility="Collapsed"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Background" Value="{StaticResource ReadOnlyBackground}"/>
                                    <Setter Property="Foreground" Value="{StaticResource DisabledColor}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="ProgDate" 
                                            Binding="{Binding ProgDate}"
                                            Width="150"
                                            Visibility="Collapsed"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Background" Value="{StaticResource ReadOnlyBackground}"/>
                                    <Setter Property="Foreground" Value="{StaticResource DisabledColor}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <!-- Client Values -->
                        <DataGridTextColumn Header="ClientEquivQty" 
                                                Binding="{Binding ClientEquivQty, StringFormat=N2}" 
                                                Width="150"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="ClientBudget" 
                                                Binding="{Binding ClientBudget, StringFormat=N2}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Val UDF3" 
                                                Binding="{Binding ClientCustom3, StringFormat=N2}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="ClientEquivEarnQTY" 
                                                Binding="{Binding ClientEquivEarnQTY, StringFormat=N3}" 
                                                Width="150"
                                                IsReadOnly="True"
                                                Visibility="Collapsed">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Background" Value="{StaticResource ReadOnlyBackground}"/>
                                    <Setter Property="Foreground" Value="{StaticResource DisabledColor}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                    </DataGrid.Columns>
                </DataGrid>
            </Border>

            <!-- PAGING CONTROLS (Bottom toolbar) -->
            <Border Grid.Row="3" 
                    Background="{StaticResource ToolbarBackground}" 
                    BorderBrush="{StaticResource BorderColor}" 
                    BorderThickness="0,1,0,0"
                    Padding="10,0">
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center">
                    <Button x:Name="btnFirstPage"
                            Content="⏮ First"
                            Width="80"
                            Height="28"
                            Margin="5,0"
                            BorderBrush="{StaticResource BorderColor}"
                            BorderThickness="1"
                            Click="BtnFirstPage_Click"/>

                    <Button x:Name="btnPreviousPage"
                            Content="◀ Previous"
                            Width="90"
                            Height="28"
                            Margin="5,0"
                            BorderBrush="{StaticResource BorderColor}"
                            BorderThickness="1"
                            Click="BtnPreviousPage_Click"/>

                    <TextBlock x:Name="txtPageInfo"
                               Text="{Binding CurrentPageDisplay}"
                               Foreground="{StaticResource ForegroundColor}"
                               VerticalAlignment="Center"
                               Margin="20,0"
                               FontWeight="Bold"/>

                    <Button x:Name="btnNextPage"
                            Content="Next ▶"
                            Width="90"
                            Height="28"
                            Margin="5,0"
                            BorderBrush="{StaticResource BorderColor}"
                            BorderThickness="1"
                            Click="BtnNextPage_Click"/>

                    <Button x:Name="btnLastPage"
                            Content="Last ⏭"
                            Width="80"
                            Height="28"
                            Margin="5,0"
                            BorderBrush="{StaticResource BorderColor}"
                            BorderThickness="1"
                            Click="BtnLastPage_Click"/>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</UserControl>