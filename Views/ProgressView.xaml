<UserControl x:Class="VANTAGE.Views.ProgressView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="1200"
             Background="{StaticResource BackgroundColor}">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="200"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- LEFT SIDEBAR: Quick Filters & Controls -->
        <Border Grid.Column="0" 
                Background="{StaticResource SidebarBackground}" 
                BorderBrush="{StaticResource SidebarBorder}" 
                BorderThickness="0,0,1,0"
                Padding="10">
            <StackPanel>
                <TextBlock Text="QUICK FILTERS" 
                           FontSize="12" 
                           FontWeight="Bold"
                           Foreground="{StaticResource TextColorSecondary}"
                           Margin="0,0,0,10"/>

                <Button x:Name="btnFilterComplete"
                        Content="Complete"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterComplete_Click"/>

                <Button x:Name="btnFilterNotComplete"
                        Content="Not Complete"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterNotComplete_Click"/>

                <Button x:Name="btnFilterPipe"
                        Content="Pipe"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterPipe_Click"/>

                <Button x:Name="btnFilterSteel"
                        Content="Steel"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterSteel_Click"/>

                <Button x:Name="btnFilterElec"
                        Content="Elec"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterElec_Click"/>

                <Button x:Name="btnFilterMyRecords"
                        Content="My Records"
                        Height="35"
                        Margin="0,0,0,5"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Left"
                        Padding="10,0"
                        Click="BtnFilterMyRecords_Click"/>

                <Button x:Name="btnClearFilters"
                        Content="Clear All Filters"
                        Height="35"
                        Margin="0,20,0,0"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource AccentColor}"
                        BorderThickness="1"
                        HorizontalContentAlignment="Center"
                        Padding="10,0"
                        Click="BtnClearFilters_Click"/>

                <Border Height="1" 
                        Background="{StaticResource BorderColor}" 
                        Margin="0,20,0,20"/>

                <TextBlock Text="COLUMN VISIBILITY" 
                           FontSize="12" 
                           FontWeight="Bold"
                           Foreground="{StaticResource TextColorSecondary}"
                           Margin="0,0,0,10"/>

                <ListBox x:Name="lstColumnVisibility"
                         Height="200"
                         Background="{StaticResource ControlBackground}"
                         Foreground="{StaticResource ForegroundColor}"
                         BorderBrush="{StaticResource BorderColor}"
                         BorderThickness="1"
                         SelectionMode="Multiple"
                         SelectionChanged="LstColumnVisibility_SelectionChanged">
                </ListBox>

                <TextBlock Text="Select columns to show/hide" 
                           FontSize="10" 
                           Foreground="{StaticResource DisabledColor}"
                           Margin="0,5,0,0"
                           TextWrapping="Wrap"/>
            </StackPanel>
        </Border>

        <!-- RIGHT SIDE: DataGrid -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="40"/>
            </Grid.RowDefinitions>

            <!-- Top toolbar -->
            <Border Grid.Row="0" 
                    Background="{StaticResource ToolbarBackground}" 
                    BorderBrush="{StaticResource BorderColor}" 
                    BorderThickness="0,0,0,1"
                    Padding="10,0">
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="Search:" 
                               Foreground="{StaticResource TextColorSecondary}" 
                               VerticalAlignment="Center"
                               Margin="0,0,10,0"/>
                    <TextBox x:Name="txtSearch"
                             Width="250"
                             Height="25"
                             Background="{StaticResource ControlBackground}"
                             Foreground="{StaticResource ForegroundColor}"
                             BorderBrush="{StaticResource BorderColor}"
                             BorderThickness="1"
                             Padding="5"
                             VerticalContentAlignment="Center"
                             TextChanged="TxtSearch_TextChanged"/>

                    <Button x:Name="btnRefresh"
                            Content="Refresh"
                            Width="80"
                            Height="28"
                            Margin="20,0,0,0"
                            Background="{StaticResource ControlBackground}"
                            Foreground="{StaticResource ForegroundColor}"
                            BorderBrush="{StaticResource BorderColor}"
                            BorderThickness="1"
                            Click="BtnRefresh_Click"/>

                    <TextBlock x:Name="txtFilteredCount"
                               Text="0 records"
                               Foreground="{StaticResource TextColorSecondary}"
                               VerticalAlignment="Center"
                               Margin="20,0,0,0"/>
                </StackPanel>
            </Border>

            <!-- DataGrid with VIRTUALIZATION ENABLED -->
            <Border Grid.Row="1" 
                    BorderBrush="{StaticResource BorderColor}" 
                    BorderThickness="0">
                <DataGrid x:Name="dgActivities"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          CanUserReorderColumns="True"
                          CanUserSortColumns="True"
                          SelectionMode="Extended"
                          SelectionUnit="FullRow"
                          EnableRowVirtualization="True"
                          EnableColumnVirtualization="True"
                          VirtualizingPanel.IsVirtualizing="True"
                          VirtualizingPanel.VirtualizationMode="Recycling"
                          Background="{StaticResource BackgroundColor}"
                          Foreground="{StaticResource ForegroundColor}"
                          BorderBrush="{StaticResource BorderColor}"
                          BorderThickness="0"
                          GridLinesVisibility="All"
                          HorizontalGridLinesBrush="{StaticResource BorderColor}"
                          VerticalGridLinesBrush="{StaticResource BorderColor}"
                          RowHeight="28"
                          HeadersVisibility="Column"
                          CellEditEnding="DgActivities_CellEditEnding"
                          SelectionChanged="DgActivities_SelectionChanged">

                    <DataGrid.ColumnHeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="Background" Value="{StaticResource GridHeaderBackground}"/>
                            <Setter Property="Foreground" Value="{StaticResource GridHeaderForeground}"/>
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Setter Property="FontSize" Value="12"/>
                            <Setter Property="Padding" Value="8,5"/>
                            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
                            <Setter Property="BorderThickness" Value="0,0,1,1"/>
                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                        </Style>
                    </DataGrid.ColumnHeaderStyle>

                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <Setter Property="Background" Value="{StaticResource BackgroundColor}"/>
                            <Setter Property="Foreground" Value="{StaticResource ForegroundColor}"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsMyRecord}" Value="True">
                                    <Setter Property="Background" Value="{StaticResource MyRecordsBackground}"/>
                                </DataTrigger>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="{StaticResource GridSelectedRowBackground}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.RowStyle>

                    <DataGrid.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
                            <Setter Property="BorderThickness" Value="0,0,1,0"/>
                            <Setter Property="Padding" Value="5,0"/>
                            <Style.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="{StaticResource GridSelectedRowBackground}"/>
                                    <Setter Property="Foreground" Value="{StaticResource ForegroundColor}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.CellStyle>

                    <DataGrid.ContextMenu>
                        <ContextMenu Background="{StaticResource ControlBackground}" 
                                     Foreground="{StaticResource ForegroundColor}"
                                     BorderBrush="{StaticResource BorderColor}">
                            <MenuItem Header="Assign to Me" 
                                      Click="MenuAssignToMe_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"/>
                            <MenuItem Header="Assign to User..." 
                                      Click="MenuAssignToUser_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"/>
                            <Separator Background="{StaticResource BorderColor}"/>
                            <MenuItem Header="Mark Complete (100%)" 
                                      Click="MenuMarkComplete_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"/>
                            <MenuItem Header="Mark Not Started (0%)" 
                                      Click="MenuMarkNotStarted_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"/>
                            <MenuItem Header="Update Percent..." 
                                      Click="MenuUpdatePercent_Click"
                                      Background="{StaticResource ControlBackground}"
                                      Foreground="{StaticResource ForegroundColor}"/>
                        </ContextMenu>
                    </DataGrid.ContextMenu>

                    <!-- ALL YOUR EXISTING COLUMNS (keeping them exactly as they are) -->
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Activity ID" 
                                            Binding="{Binding UDFNineteen}" 
                                            Width="120"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Background" Value="{StaticResource ControlBackground}"/>
                                    <Setter Property="Foreground" Value="{StaticResource DisabledColor}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="Description" 
                                            Binding="{Binding Tag_Descriptions}" 
                                            Width="250"/>

                        <DataGridTextColumn Header="Component Type" 
                                            Binding="{Binding Catg_ComponentType}" 
                                            Width="120"/>

                        <DataGridTextColumn Header="Phase Category" 
                                            Binding="{Binding Catg_PhaseCategory}" 
                                            Width="120"/>

                        <DataGridTextColumn Header="ROC Step" 
                                            Binding="{Binding Catg_ROC_Step}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="Project ID" 
                                            Binding="{Binding Tag_ProjectID}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="Work Package" 
                                            Binding="{Binding Tag_WorkPackage}" 
                                            Width="120"/>

                        <DataGridTextColumn Header="Phase Code" 
                                            Binding="{Binding Tag_Phase_Code}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="Drawing No" 
                                            Binding="{Binding Dwg_PrimeDrawingNO}" 
                                            Width="120"/>

                        <DataGridTextColumn Header="Sch Start" 
                                            Binding="{Binding Sch_Start}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="Sch Finish" 
                                            Binding="{Binding Sch_Finish}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="Sch Status" 
                                            Binding="{Binding Sch_Status}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="Activity No" 
                                            Binding="{Binding Tag_Sch_ActNo}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="Quantity" 
                                            Binding="{Binding Val_Quantity, StringFormat=N2}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="Earned Qty" 
                                            Binding="{Binding Val_EarnedQty, StringFormat=N2, UpdateSourceTrigger=LostFocus}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="% Complete" 
                                            Binding="{Binding Val_Perc_Complete, StringFormat=N2, UpdateSourceTrigger=LostFocus}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="Budget Hrs" 
                                            Binding="{Binding Val_BudgetedHours_Ind, StringFormat=N2}" 
                                            Width="100"/>

                        <DataGridTextColumn Header="Earned Hrs" 
                                            Binding="{Binding Val_EarnedHours_Ind, StringFormat=N3}" 
                                            Width="100"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Background" Value="{StaticResource GridAlternatingRowBackground}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="Status" 
                                            Binding="{Binding Status}" 
                                            Width="100"
                                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Background" Value="{StaticResource GridAlternatingRowBackground}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="UDF One" 
                                            Binding="{Binding UDFOne}" 
                                            Width="120"/>

                        <DataGridTextColumn Header="UDF Two" 
                                            Binding="{Binding UDFTwo}" 
                                            Width="120"/>

                        <DataGridTextColumn Header="Assigned To" 
                                            Binding="{Binding AssignedToUsername}" 
                                            Width="120"/>

                        <!-- ALL OTHER COLLAPSED COLUMNS (keeping exactly as you have them) -->
                        <DataGridTextColumn Header="Hex NO" 
                                                Binding="{Binding HexNO}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <!-- Drawings -->
                        <DataGridTextColumn Header="Revision No" 
                                                Binding="{Binding Dwg_RevisionNo}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Secondary Drawing" 
                                                Binding="{Binding Dwg_SecondaryDrawingNO}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Sheet No" 
                                                Binding="{Binding Dwg_ShtNo}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <!-- Notes -->
                        <DataGridTextColumn Header="Comments" 
                                                Binding="{Binding Notes_Comments}" 
                                                Width="200"
                                                Visibility="Collapsed"/>

                        <!-- Schedule Additional -->
                        <DataGridTextColumn Header="Sch Act No (Field)" 
                                                Binding="{Binding Sch_Actno}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <!-- Tags - Auxiliary -->
                        <DataGridTextColumn Header="Tag Aux1" 
                                                Binding="{Binding Tag_Aux1}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Tag Aux2" 
                                                Binding="{Binding Tag_Aux2}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Tag Aux3" 
                                                Binding="{Binding Tag_Aux3}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Tag Area" 
                                                Binding="{Binding Tag_Area}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="CO No" 
                                                Binding="{Binding Tag_CONo}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Equipment No" 
                                                Binding="{Binding Tag_EqmtNo}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Estimator" 
                                                Binding="{Binding Tag_Estimator}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Insulation Type" 
                                                Binding="{Binding Tag_Insulation_Typ}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Line No" 
                                                Binding="{Binding Tag_LineNo}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Material Spec" 
                                                Binding="{Binding Tag_Matl_Spec}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Paint Code" 
                                                Binding="{Binding Tag_Paint_Code}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Pipe Grade" 
                                                Binding="{Binding Tag_Pipe_Grade}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="RFI No" 
                                                Binding="{Binding Tag_RFINo}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Service" 
                                                Binding="{Binding Tag_Service}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Shop/Field" 
                                                Binding="{Binding Tag_ShopField}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Sub Area" 
                                                Binding="{Binding Tag_SubArea}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="System" 
                                                Binding="{Binding Tag_System}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="System No" 
                                                Binding="{Binding Tag_SystemNo}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Tag No" 
                                                Binding="{Binding Tag_TagNo}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Tracing" 
                                                Binding="{Binding Tag_Tracing}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="XRAY" 
                                                Binding="{Binding Tag_XRAY, StringFormat=N2}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <!-- Trigger -->
                        <DataGridTextColumn Header="Date Trigger" 
                                                Binding="{Binding Trg_DateTrigger}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <!-- UDF Fields (remaining) -->
                        <DataGridTextColumn Header="UDF Three" 
                                                Binding="{Binding UDFThree}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF Four" 
                                                Binding="{Binding UDFFour}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF Five" 
                                                Binding="{Binding UDFFive}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF Six" 
                                                Binding="{Binding UDFSix}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF Seven" 
                                                Binding="{Binding UDFSeven}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF Eight" 
                                                Binding="{Binding UDFEight}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF Nine" 
                                                Binding="{Binding UDFNine}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF Ten" 
                                                Binding="{Binding UDFTen}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Last Modified By" 
                                                Binding="{Binding LastModifiedBy}" 
                                                Width="150"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Created By" 
                                                Binding="{Binding CreatedBy}" 
                                                Width="150"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF Fourteen" 
                                                Binding="{Binding UDFFourteen}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF Fifteen" 
                                                Binding="{Binding UDFFifteen}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF Sixteen" 
                                                Binding="{Binding UDFSixteen}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF Seventeen" 
                                                Binding="{Binding UDFSeventeen}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF Eighteen" 
                                                Binding="{Binding UDFEighteen}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF Twenty" 
                                                Binding="{Binding UDFTwenty}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <!-- Values - Additional -->
                        <DataGridTextColumn Header="Base Unit" 
                                                Binding="{Binding Val_Base_Unit, StringFormat=N2}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Budget Hrs Group" 
                                                Binding="{Binding Val_BudgetedHours_Group, StringFormat=N2}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Budget Hrs ROC" 
                                                Binding="{Binding Val_BudgetedHours_ROC, StringFormat=N2}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Earned Hrs ROC" 
                                                Binding="{Binding Val_EarnedHours_ROC}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UOM" 
                                                Binding="{Binding Val_UOM}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <!-- Calculated fields -->
                        <DataGridTextColumn Header="Earn Qty (Calc)" 
                                                Binding="{Binding Val_Earn_Qty, StringFormat=N4}" 
                                                Width="100"
                                                IsReadOnly="True"
                                                Visibility="Collapsed">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Background" Value="{StaticResource GridAlternatingRowBackground}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="Percent Earned" 
                                                Binding="{Binding Val_Percent_Earned, StringFormat=N4}" 
                                                Width="120"
                                                IsReadOnly="True"
                                                Visibility="Collapsed">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Background" Value="{StaticResource GridAlternatingRowBackground}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <!-- Equipment Quantity -->
                        <DataGridTextColumn Header="EQ QTY" 
                                                Binding="{Binding Val_EQ_QTY, StringFormat=N2}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="EQ UOM" 
                                                Binding="{Binding Val_EQ_UOM}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <!-- ROC -->
                        <DataGridTextColumn Header="ROC ID" 
                                                Binding="{Binding Tag_ROC_ID}" 
                                                Width="80"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Lookup ROC ID" 
                                                Binding="{Binding LookUP_ROC_ID}" 
                                                Width="200"
                                                IsReadOnly="True"
                                                Visibility="Collapsed">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Background" Value="{StaticResource GridAlternatingRowBackground}"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="ROC Perc" 
                                                Binding="{Binding Val_ROC_Perc, StringFormat=N2}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="ROC Budget Qty" 
                                                Binding="{Binding Val_ROC_BudgetQty, StringFormat=N2}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <!-- Pipe -->
                        <DataGridTextColumn Header="Pipe Size 1" 
                                                Binding="{Binding Val_Pipe_Size1, StringFormat=N2}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Pipe Size 2" 
                                                Binding="{Binding Val_Pipe_Size2, StringFormat=N2}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <!-- Previous Values -->
                        <DataGridTextColumn Header="Prev Earned Hrs" 
                                                Binding="{Binding Val_Prev_Earned_Hours, StringFormat=N2}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Prev Earned Qty" 
                                                Binding="{Binding Val_Prev_Earned_Qty, StringFormat=N2}" 
                                                Width="120"
                                                Visibility="Collapsed"/>

                        <!-- Timestamp -->
                        <DataGridTextColumn Header="Timestamp" 
                                                Binding="{Binding Val_TimeStamp}" 
                                                Width="150"
                                                Visibility="Collapsed"/>

                        <!-- Client Values -->
                        <DataGridTextColumn Header="Client EQ QTY Budget" 
                                                Binding="{Binding Val_Client_EQ_QTY_BDG, StringFormat=N2}" 
                                                Width="150"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF Two (Val)" 
                                                Binding="{Binding Val_UDF_Two, StringFormat=N2}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="UDF Three (Val)" 
                                                Binding="{Binding Val_UDF_Three, StringFormat=N2}" 
                                                Width="100"
                                                Visibility="Collapsed"/>

                        <DataGridTextColumn Header="Client Earned EQ QTY" 
                                                Binding="{Binding VAL_Client_Earned_EQ_QTY, StringFormat=N3}" 
                                                Width="150"
                                                IsReadOnly="True"
                                                Visibility="Collapsed"/>

                    </DataGrid.Columns>
                </DataGrid>
            </Border>

            <!-- PAGING CONTROLS (Bottom toolbar) -->
            <Border Grid.Row="2" 
                    Background="{StaticResource ToolbarBackground}" 
                    BorderBrush="{StaticResource BorderColor}" 
                    BorderThickness="0,1,0,0"
                    Padding="10,0">
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center">
                    <Button x:Name="btnFirstPage"
                            Content="⏮ First"
                            Width="80"
                            Height="28"
                            Margin="5,0"
                            BorderBrush="{StaticResource BorderColor}"
                            BorderThickness="1"
                            Click="BtnFirstPage_Click"/>

                    <Button x:Name="btnPreviousPage"
                            Content="◀ Previous"
                            Width="90"
                            Height="28"
                            Margin="5,0"
                            BorderBrush="{StaticResource BorderColor}"
                            BorderThickness="1"
                            Click="BtnPreviousPage_Click"/>

                    <TextBlock x:Name="txtPageInfo"
                               Text="Page 1 of 1"
                               Foreground="{StaticResource ForegroundColor}"
                               VerticalAlignment="Center"
                               Margin="20,0"
                               FontWeight="Bold"/>

                    <Button x:Name="btnNextPage"
                            Content="Next ▶"
                            Width="90"
                            Height="28"
                            Margin="5,0"
                            BorderBrush="{StaticResource BorderColor}"
                            BorderThickness="1"
                            Click="BtnNextPage_Click"/>

                    <Button x:Name="btnLastPage"
                            Content="Last ⏭"
                            Width="80"
                            Height="28"
                            Margin="5,0"
                            BorderBrush="{StaticResource BorderColor}"
                            BorderThickness="1"
                            Click="BtnLastPage_Click"/>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</UserControl>