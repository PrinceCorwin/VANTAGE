<Window x:Class="VANTAGE.Dialogs.ProrateDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Prorate Budget MHs"
        Height="520"
        Width="400"
        WindowStartupLocation="CenterOwner"
        Background="{StaticResource BackgroundColor}"
        ResizeMode="NoResize"
        WindowStyle="SingleBorderWindow">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="15"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="15"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="15"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="20"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="20"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Operation Section -->
        <StackPanel Grid.Row="0">
            <TextBlock Text="Operation"
                       FontWeight="SemiBold"
                       FontSize="14"
                       Foreground="{StaticResource ForegroundColor}"
                       Margin="0,0,0,8"/>
            <StackPanel Orientation="Horizontal">
                <RadioButton x:Name="rbNewTotal"
                             Content="New Total"
                             GroupName="Operation"
                             IsChecked="True"
                             Foreground="{StaticResource ForegroundColor}"
                             Margin="0,0,20,0"
                             Checked="Operation_Changed"
                             ToolTip="Set the total BudgetMHs to a specific value"/>
                <RadioButton x:Name="rbAdd"
                             Content="Add"
                             GroupName="Operation"
                             Foreground="{StaticResource ForegroundColor}"
                             Margin="0,0,20,0"
                             Checked="Operation_Changed"
                             ToolTip="Add MHs to the current total"/>
                <RadioButton x:Name="rbSubtract"
                             Content="Subtract"
                             GroupName="Operation"
                             Foreground="{StaticResource ForegroundColor}"
                             Checked="Operation_Changed"
                             ToolTip="Subtract MHs from the current total"/>
            </StackPanel>
        </StackPanel>

        <!-- Amount Section -->
        <StackPanel Grid.Row="2">
            <TextBlock Text="Amount (MHs)"
                       FontWeight="SemiBold"
                       FontSize="14"
                       Foreground="{StaticResource ForegroundColor}"
                       Margin="0,0,0,8"/>
            <TextBox x:Name="txtAmount"
                     Height="32"
                     Background="{StaticResource ControlBackground}"
                     Foreground="{StaticResource ForegroundColor}"
                     BorderBrush="{StaticResource ControlBorder}"
                     VerticalContentAlignment="Center"
                     Padding="8,0"
                     TextChanged="TxtAmount_TextChanged"
                     PreviewTextInput="TxtAmount_PreviewTextInput"
                     ToolTip="Enter the MHs value for the selected operation"/>
        </StackPanel>

        <!-- Preserve Section -->
        <StackPanel Grid.Row="4">
            <TextBlock Text="Preserve"
                       FontWeight="SemiBold"
                       FontSize="14"
                       Foreground="{StaticResource ForegroundColor}"
                       Margin="0,0,0,8"/>
            <RadioButton x:Name="rbKeepPercent"
                         Content="Keep Percent Complete (Earned recalculates)"
                         GroupName="Preserve"
                         Foreground="{StaticResource ForegroundColor}"
                         Margin="0,0,0,6"
                         Checked="Preserve_Changed"
                         ToolTip="Earned MHs will scale proportionally with budget changes"/>
            <RadioButton x:Name="rbKeepEarned"
                         Content="Keep Earned MHs (Percent recalculates)"
                         GroupName="Preserve"
                         IsChecked="True"
                         Foreground="{StaticResource ForegroundColor}"
                         Checked="Preserve_Changed"
                         ToolTip="Earned MHs stays fixed, only remaining MHs changes"/>
        </StackPanel>

        <!-- Preview Section -->
        <Border Grid.Row="6"
                Background="{StaticResource ControlBackground}"
                BorderBrush="{StaticResource ControlBorder}"
                BorderThickness="1"
                CornerRadius="4"
                Padding="12">
            <StackPanel>
                <TextBlock Text="Preview"
                           FontWeight="SemiBold"
                           FontSize="13"
                           Foreground="{StaticResource ForegroundColor}"
                           Margin="0,0,0,8"/>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="4"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="4"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Grid.Column="0"
                               Text="Eligible Activities:"
                               Foreground="{StaticResource TextColorSecondary}"/>
                    <TextBlock x:Name="txtEligibleCount"
                               Grid.Row="0" Grid.Column="1"
                               Text="0"
                               Foreground="{StaticResource ForegroundColor}"
                               HorizontalAlignment="Right"/>

                    <TextBlock Grid.Row="2" Grid.Column="0"
                               Text="Current Total:"
                               Foreground="{StaticResource TextColorSecondary}"/>
                    <TextBlock x:Name="txtCurrentTotal"
                               Grid.Row="2" Grid.Column="1"
                               Text="0.000"
                               Foreground="{StaticResource ForegroundColor}"
                               HorizontalAlignment="Right"/>

                    <TextBlock Grid.Row="4" Grid.Column="0"
                               Text="New Total:"
                               Foreground="{StaticResource TextColorSecondary}"/>
                    <TextBlock x:Name="txtNewTotal"
                               Grid.Row="4" Grid.Column="1"
                               Text="0.000"
                               Foreground="{StaticResource StatusGreen}"
                               FontWeight="SemiBold"
                               HorizontalAlignment="Right"/>
                </Grid>
            </StackPanel>
        </Border>

        <!-- Skipped Info -->
        <TextBlock x:Name="txtSkippedInfo"
                   Grid.Row="8"
                   Text=""
                   Foreground="{StaticResource TextColorSecondary}"
                   FontSize="12"
                   TextWrapping="Wrap"/>

        <!-- Buttons -->
        <StackPanel Grid.Row="10"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right">
            <Button x:Name="btnApply"
                    Content="Apply"
                    Width="80"
                    Height="32"
                    Margin="0,0,10,0"
                    Background="{StaticResource ControlBackground}"
                    Foreground="{StaticResource StatusGreen}"
                    BorderBrush="{StaticResource ControlBorder}"
                    Click="BtnApply_Click"
                    IsEnabled="False"
                    ToolTip="Apply the prorate to eligible activities"/>
            <Button x:Name="btnCancel"
                    Content="Cancel"
                    Width="80"
                    Height="32"
                    Background="{StaticResource ControlBackground}"
                    Foreground="{StaticResource ForegroundColor}"
                    BorderBrush="{StaticResource ControlBorder}"
                    Click="BtnCancel_Click"
                    ToolTip="Cancel and close the dialog"/>
        </StackPanel>
    </Grid>
</Window>
