<Window x:Class="VANTAGE.Dialogs.UninstallDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Uninstall VANTAGE: Milestone"
        Height="320"
        Width="480"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource BackgroundColor}"
        ResizeMode="NoResize"
        WindowStyle="SingleBorderWindow">

    <Grid Margin="24">
        <!-- Page 1: Confirmation -->
        <Grid x:Name="pageConfirm">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="15"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="24"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBlock Grid.Row="0"
                       FontSize="16"
                       FontWeight="SemiBold"
                       Foreground="{StaticResource ForegroundColor}">
                Uninstall VANTAGE: Milestone?
            </TextBlock>

            <TextBlock Grid.Row="2"
                       TextWrapping="Wrap"
                       Foreground="{StaticResource TextColorSecondary}"
                       FontSize="13"
                       LineHeight="22">
                This will remove the following from your computer:
            </TextBlock>

            <StackPanel Grid.Row="3" Margin="12,6,0,0">
                <TextBlock Foreground="{StaticResource TextColorSecondary}" FontSize="13" Text="&#x2022;  Application files"/>
                <TextBlock Foreground="{StaticResource TextColorSecondary}" FontSize="13" Text="&#x2022;  Desktop and Start Menu shortcuts" Margin="0,3,0,0"/>
                <TextBlock Foreground="{StaticResource TextColorSecondary}" FontSize="13" Text="&#x2022;  Windows registry entries" Margin="0,3,0,0"/>
            </StackPanel>

            <CheckBox x:Name="chkKeepData"
                      Grid.Row="4"
                      Content="Keep local data (database and settings)"
                      IsChecked="True"
                      Foreground="{StaticResource ForegroundColor}"
                      FontSize="13"
                      ToolTip="If unchecked, the local database and all settings will be permanently deleted"/>

            <StackPanel Grid.Row="6" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Cancel"
                        Width="100" Height="34"
                        Margin="0,0,10,0"
                        Background="{StaticResource ControlBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource ControlBorder}"
                        BorderThickness="1"
                        Click="BtnCancel_Click"
                        IsCancel="True"/>
                <Button Content="Uninstall"
                        Width="100" Height="34"
                        Background="{StaticResource ButtonDangerBackground}"
                        Foreground="{StaticResource ForegroundColor}"
                        BorderBrush="{StaticResource ButtonDangerBorder}"
                        BorderThickness="1"
                        Click="BtnUninstall_Click"/>
            </StackPanel>
        </Grid>

        <!-- Page 2: Progress -->
        <Grid x:Name="pageProgress" Visibility="Collapsed">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="24"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <TextBlock Grid.Row="0"
                       FontSize="16"
                       FontWeight="SemiBold"
                       Foreground="{StaticResource ForegroundColor}">
                Uninstalling...
            </TextBlock>

            <ProgressBar Grid.Row="2"
                         x:Name="progressBar"
                         Height="4"
                         IsIndeterminate="True"
                         Foreground="{StaticResource AccentColor}"
                         Background="{StaticResource ControlBackground}"/>

            <StackPanel Grid.Row="3" Margin="0,16,0,0">
                <TextBlock x:Name="txtStep1" FontSize="13" Foreground="{StaticResource TextColorSecondary}" Text="  Removing shortcuts..."/>
                <TextBlock x:Name="txtStep2" FontSize="13" Foreground="{StaticResource TextColorSecondary}" Text="  Removing registry entries..." Margin="0,6,0,0"/>
                <TextBlock x:Name="txtStep3" FontSize="13" Foreground="{StaticResource TextColorSecondary}" Text="  Cleaning up application files..." Margin="0,6,0,0"/>
                <TextBlock x:Name="txtStep4" FontSize="13" Foreground="{StaticResource TextColorSecondary}" Text="  Removing local data..." Margin="0,6,0,0" Visibility="Collapsed"/>
            </StackPanel>
        </Grid>

        <!-- Page 3: Complete -->
        <Grid x:Name="pageComplete" Visibility="Collapsed">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="16"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBlock Grid.Row="0"
                       FontSize="16"
                       FontWeight="SemiBold"
                       Foreground="{StaticResource StatusGreen}">
                Uninstall Complete
            </TextBlock>

            <TextBlock Grid.Row="2"
                       TextWrapping="Wrap"
                       Foreground="{StaticResource ForegroundColor}"
                       FontSize="13"
                       LineHeight="22">
                VANTAGE: Milestone has been successfully removed from your computer.
            </TextBlock>

            <TextBlock x:Name="txtDataKept"
                       Grid.Row="3"
                       Margin="0,12,0,0"
                       TextWrapping="Wrap"
                       Foreground="{StaticResource TextColorSecondary}"
                       FontSize="12"
                       VerticalAlignment="Top"/>

            <Button Content="Close"
                    Grid.Row="4"
                    Width="100" Height="34"
                    HorizontalAlignment="Right"
                    Background="{StaticResource ControlBackground}"
                    Foreground="{StaticResource ForegroundColor}"
                    BorderBrush="{StaticResource ControlBorder}"
                    BorderThickness="1"
                    Click="BtnClose_Click"/>
        </Grid>
    </Grid>
</Window>
